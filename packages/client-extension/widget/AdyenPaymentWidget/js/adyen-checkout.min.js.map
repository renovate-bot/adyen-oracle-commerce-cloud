{"version":3,"file":"adyen-checkout.min.js","sources":["constants/index.js","utils/spinner.js","utils/ajax.js","utils/redirectAuth.js","utils/getOrderPayload.js","utils/events.js","utils/getInstallmentOptions.js","utils/checkout.js","utils/modal.js","utils/createError.js","utils/date.js","utils/hideLoaders.js","components/component.js","components/order.js","components/payment.js","components/store.js","components/boleto/index.js","components/card/index.js","components/local/index.js","adyen-checkout.js"],"sourcesContent":["export const baseAPIUrl = '/ccstorex/custom/adyen/v1'\nexport const channels = { preview: 'preview', storefront: 'storefront' }\nexport const errorMessages = {\n    paymentRefused: 'paymentRefused',\n    installmentsConfiguration: 'installmentsConfiguration',\n    failed3dsValidation: 'failed3dsValidation',\n}\nexport const paymentMethodTypes = {\n    generic: 'generic',\n    invoice: 'invoice',\n    local: 'local',\n}\nexport const adyenUrl = env => `https://checkoutshopper-${env.toLowerCase()}.adyen.com`\nexport const adyenCssUrl = env => `${adyenUrl(env)}/checkoutshopper/sdk/3.3.0/adyen.css`\nexport const adyenCheckoutComponentUrl = env => `${adyenUrl(env)}/checkoutshopper/sdk/3.3.0/adyen.js`\n\nexport const locale = 'locale'\nexport const countries = {\n    brazil: { locale: 'pt_br', currency: 'brl' },\n    mexico: { locale: 'es_mx', currency: 'mxn' },\n}\nexport const brazilEnabled = 'brazilEnabled'\nexport const comboCards = { debit: 'debitCard', credit: 'creditCard' }\nexport const bins = { electron: 'electron', maestro: 'maestro' }\nexport const storage = { paymentData: 'AdyenPaymentData', order: 'AdyenOrder' }\nexport const noInstallmentsMsg = 'noInstallmentsMsg'\n\nexport const render = 'render'\nexport const id = 'id'\nexport const order = 'order'\nexport const checkout = {\n    card: 'checkoutCard',\n    boleto: 'checkoutBoleto',\n    local: 'checkoutLocal',\n}\nexport const isLoaded = 'isLoaded'\nexport const ajax = 'ajax'\nexport const originKey = 'originKey'\nexport const installments = 'installments'\nexport const cart = 'cart'\nexport const setPayment = 'setPayment'\nexport const setDone = 'setDone'\nexport const initialOrderCreated = 'initialOrderCreated'\nexport const pageChanged = 'pageChanged'\nexport const installmentsEnabled = 'installmentsEnabled'\nexport const isAllowedCountryForInstallments = 'isAllowedCountryForInstallments'\nexport const environment = 'environment'\nexport const selectedBrand = 'selectedBrand'\nexport const selectedComboCard = 'selectedComboCard'\nexport const installmentsOptions = 'installmentOptions'\nexport const storedPaymentType = 'storedPaymentType'\nexport const paymentMethodsResponse = 'paymentMethodsResponse'\nexport const translate = 'translate'\nexport const isPaymentStored = 'isPaymentStored'\nexport const paymentDetails = 'paymentDetails'\nexport const selectedInstallment = 'selectedInstallment'\nexport const comboCardOptions = 'comboCardOptions'\nexport const genericPayment = 'genericPayment'\nexport const isDone = 'isDone'\nexport const isValid = 'isValid'\nexport const pageParams = 'pageParams'\nexport const presentToShopper = 'PresentToShopper'\nexport const orderPayload = 'orderPayload'\nexport const boleto = {\n    enabled: 'boletoEnabled',\n    deliveryDate: 'boletoDeliveryDate',\n    shopperStatement: 'boletoShopperStatement',\n}\nexport const localPaymentMethods = 'localPaymentMethods'\n","import spinner from 'spinner'\nimport $ from 'jquery'\n\nexport const createSpinner = () => {\n    const indicatorOptions = {\n        parent: '#loadingModal',\n        posTop: '20%',\n        posLeft: '50%',\n        loadingText: 'Loading',\n    }\n    $('#loadingModal').removeClass('hide')\n    $('#loadingModal').show()\n    spinner.create(indicatorOptions)\n}\n\nexport const destroySpinner = () => {\n    $('#loadingModal').hide()\n    spinner.destroy()\n}\n","import $ from 'jquery'\nimport { baseAPIUrl, channels } from '../constants'\n\nconst getData = (method, body) => method === 'post' && { data: { json: JSON.stringify(body) } }\nexport default isPreview => {\n    return (path, cb, { body, method } = { body: '', method: 'get' }) => {\n        const data = getData(method, body)\n        $.ajax({\n            url: `${baseAPIUrl}/${path}`,\n            method,\n            headers: {\n                'x-oracle-cc-webhook-signature': 'ABC123',\n                channel: isPreview ? channels.preview : channels.storefront,\n            },\n            success: cb,\n            ...data,\n        })\n    }\n}\n","import storageApi from 'storageApi'\nimport * as constants from '../constants'\nimport { store } from '../components'\nimport { createFromAction } from './index'\n\nexport default ({ order, customPaymentProperties }, cb) => {\n    const checkoutCard = store.get(constants.checkout.card)\n    const isAuthRedirect = 'paymentData' in customPaymentProperties\n    const redirect = () => {\n        const action = {\n            action: customPaymentProperties,\n            selector: '#adyen-card-payment',\n            checkoutComponent: checkoutCard,\n        }\n\n        const instance = storageApi.getInstance()\n        instance.setItem(constants.storage.paymentData, customPaymentProperties.paymentData)\n        instance.setItem(constants.storage.order, JSON.stringify(order))\n\n        createFromAction(action)\n    }\n\n    isAuthRedirect ? redirect() : cb(order)\n}\n","export default function getOrderPayload(order) {\n    const { shippingAddress: shippingAddressFn, billingAddress: billingAddressFn, cart, payments } = order()\n\n    const { billingAddress, shippingAddress, id, orderProfileId, shippingMethod, shoppingCart } = order().order()\n\n    return {\n        billingAddress: {\n            ...billingAddressFn(),\n            ...billingAddress,\n        },\n        combineLineItems: cart().combineLineItems,\n        op: 'initiate',\n        id,\n        payments: payments(),\n        profileId: orderProfileId,\n        shippingAddress: {\n            ...shippingAddressFn(),\n            ...shippingAddress,\n        },\n        shippingMethod,\n        shoppingCart,\n    }\n}\n","import $ from 'jquery'\n\nclass Emitter {\n    store = {\n        emit: (key, value) => $.Topic('store').publish(key, value),\n        listen: cb => $.Topic('store').subscribe(cb),\n    }\n\n    _ev = suffix => ({\n        emit: (event, ...args) => $.Topic(`${suffix}-${event}`).publish(...args),\n        on: (event, cb) => $.Topic(`${suffix}-${event}`).subscribe(cb),\n    })\n\n    emit = (key, ...args) => $.Topic(key).publish(...args)\n\n    payment = this._ev('payment')\n    order = this._ev('order')\n    component = this._ev('component')\n\n    on = (event, cb) => $.Topic(event).subscribe(cb)\n}\n\nexport default new Emitter()\n","const creditCards = [\n    { id: 1, name: 'Amex', code: 'amex' },\n    // {id: \"argencard\", name: \"Argencard\"},\n    // {id: \"bcmc\", name: \"Bancontact/Mister Cash\"},\n    // {id: \"bijcard\", name: \"de Bijenkorf Card\"},\n    // {id: \"cabal\", name: \"Cabal\"},\n    // {id: \"cartebancaire\", name: \"Carte Bancaires\"},\n    // {id: \"codensa\", name: \"Codensa\"},\n    // {id: \"cup\", name: \"China Union Pay\"},\n    // {id: \"dankort\", name: \"Dankort\"},\n    // {id: \"diners\", name: \"Diners Club\"},\n    // {id: \"discover\", name: \"Discover\"},\n    { id: 2, name: 'ELO', code: 'elo' },\n    // {id: \"forbrugsforeningen\", name: \"Forbrugsforeningen\"},\n    { id: 4, name: 'HiperCard', code: 'hiper' },\n    { id: 4, name: 'HiperCard', code: 'hipercard' },\n    // {id: \"jcb\", name: \"JCB\"},\n    // {id: \"karenmillen\", name: \"Karen Millen GiftCard\"},\n    // {id: \"laser\", name: \"Laser\"},\n    // {id: \"maestro\", name: \"Maestro\"},\n    // {id: \"maestrouk\", name: \"Maestro UK\"},\n    { id: 8, name: 'Mastercard', code: 'mc' },\n    // {id: \"mcalphabankbonus\", name: \"Alpha Bank Mastercard Bonus\"},\n    // {id: \"mir\", name: \"MIR\"},\n    // {id: \"naranja\", name: \"Naranja\"},\n    // {id: \"oasis\", name: \"Oasis GiftCard\"},\n    // {id: \"shopping\", name: \"Tarjeta Shopping\"},\n    // {id: \"solo\", name: \"Solo\"},\n    // {id: \"troy\", name: \"Troy\"},\n    // {id: \"uatp\", name: \"UATP\"},\n    { id: 16, name: 'Visa', code: 'visa' },\n    // {id: \"visaalphabankbonus\", name: \"Alpha Bank Visa Bonus\"},\n    // {id: \"visadankort\", name: \"Visa Dankort\"},\n    // {id: \"warehouse\", name: \"Warehouse GiftCard\"},\n]\n\nconst isAllowedCreditCard = (creditCard, creditCardSum) => (parseInt(creditCardSum) & creditCard.id) !== 0\nconst checkSum = (creditCard, creditCardSum) => creditCard && isAllowedCreditCard(creditCard, creditCardSum)\nconst checkAmount = (amount, amountRange) => amount >= amountRange\nconst validate = (hasValidSum, isValidAmount) => hasValidSum && isValidAmount\n\nfunction getInstallmentOptions(installmentsOptions, amount, brand) {\n    const creditCard = creditCards.find(({ code }) => brand === code)\n    const createInstallmentsObj = item => {\n        const [amountRange, numberOfInstallments, creditCardSum] = item\n        const hasValidSum = checkSum(creditCard, creditCardSum)\n        const isValidAmount = checkAmount(amount, amountRange)\n        const isValid = validate(hasValidSum, isValidAmount)\n\n        return isValid && { numberOfInstallments }\n    }\n\n    return installmentsOptions.map(createInstallmentsObj, []).filter(valid => valid)\n}\n\nexport default getInstallmentOptions\n","import ccConstants from 'ccConstants'\nimport { store } from '../components'\nimport * as constants from '../constants'\nimport { eventEmitter } from './index'\n\nexport const getDefaultConfig = () => {\n    const environment = store.get(constants.environment)\n    const locale = store.get(constants.locale)\n    const originKey = store.get(constants.originKey)\n    const paymentMethodsResponse = store.get(constants.paymentMethodsResponse)\n\n    return {\n        showPayButton: true,\n        locale,\n        environment: environment.toLowerCase(),\n        originKey,\n        paymentMethodsResponse,\n    }\n}\n\nexport const createFromAction = ({ action, selector, checkoutComponent }) => {\n    checkoutComponent.createFromAction(action).mount(selector)\n}\n\nclass Checkout {\n    constructor(type) {\n        this.type = type\n    }\n\n    createCheckout = ({ configuration, selector, type, options = {} }, cb) => {\n        const defaultConfiguration = getDefaultConfig()\n        // eslint-disable-next-line no-undef\n        const checkout = new AdyenCheckout({ ...defaultConfiguration, ...configuration })\n        checkout.create(type, options).mount(selector)\n\n        cb(checkout)\n    }\n\n    onSubmit = () => () => {\n        const loader = document.querySelector(`#adyen-${this.type}-wrapper .loader-wrapper`)\n        loader && loader.classList.toggle('hide', false)\n\n        const order = store.get(constants.order)\n        eventEmitter.payment.emit(constants.setPayment, this.type)\n\n        order().id(null)\n        order().op(ccConstants.ORDER_OP_INITIATE)\n        order().handlePlaceOrder()\n    }\n\n    onChange = options => (state, component) => {\n        const paymentDetails = store.get(constants.paymentDetails)\n        const isValid = component.isValid && typeof state.data === 'object'\n        eventEmitter.store.emit(constants.isValid, isValid)\n\n        const payload = { ...paymentDetails, [this.type]: { ...state.data, ...options } }\n\n        eventEmitter.store.emit(constants.paymentDetails, payload)\n    }\n}\n\nexport default Checkout\n","import { store } from '../components'\nimport * as constants from '../constants'\n\nexport const createPresentToShopperModal = cb => {\n    const node = document.createElement('div')\n    node.setAttribute(\n        'style',\n        'display: flex;justify-content: center;align-content: center;top: 0;position: fixed;z-index: 999;' +\n            'align-items: center;'\n    )\n\n    const wrapper = document.createElement('div')\n    wrapper.setAttribute('style', 'height: 100vh; width: 100vw; background-color: #a4a4a494; z-index: 999;')\n    wrapper.setAttribute('id', 'present-shopper-wrapper')\n\n    const modal = document.createElement('div')\n    modal.setAttribute('id', 'present-shopper')\n    modal.setAttribute('style', 'z-index: 9999;position: absolute;')\n\n    const clickEvent = () => {\n        wrapper.removeEventListener('click', clickEvent)\n        node.remove()\n    }\n\n    wrapper.addEventListener('click', clickEvent)\n\n    const environment = store.get(constants.environment)\n\n    node.innerHTML = `<link \n        rel=\"stylesheet\" \n        href=\"https://checkoutshopper-${environment}.adyen.com/checkoutshopper/sdk/3.2.0/adyen.css\" \n        />`\n\n    node.appendChild(modal)\n    node.appendChild(wrapper)\n\n    document.body.appendChild(node)\n    cb(node)\n}\n","import notifier from 'notifier'\nimport navigation from 'navigation'\nimport { destroySpinner } from './spinner'\n\nconst createError = (options, preserveUrl = false) => ({ errorMessage = 'The payment is REFUSED.' } = {}) => {\n    'redirectLink' in options && navigation.goTo(options.redirectLink, preserveUrl)\n    destroySpinner()\n    notifier.sendError('adyen', errorMessage, true)\n}\n\nexport default createError\n","export const addDays = days => new Date().setDate(new Date().getDate() + days)\n","const hideLoaders = () => {\n    const toggleElementAttribute = el => el.classList.toggle('hide', true)\n    document.querySelectorAll('.loader-wrapper').forEach(toggleElementAttribute)\n}\n\nexport default hideLoaders\n","import $ from 'jquery'\nimport * as constants from '../constants'\nimport { eventEmitter } from '../utils'\nimport { createBoletoCheckout, createCardCheckout, createLocalPaymentCheckout, store } from './index'\n\nclass Component {\n    constructor() {\n        this.startEventListeners()\n    }\n\n    startEventListeners = () => {\n        eventEmitter.component.on(constants.render, this.render)\n        eventEmitter.component.on(constants.comboCardOptions, this.getComboCardOptions)\n    }\n\n    getBrand = (brands, brand) =>\n        brand in brands ? brands[store.get(constants.selectedBrand)] : store.get(constants.selectedBrand)\n    getComboCardOptions = () => {\n        const brands = { visa: constants.bins.electron, mastercard: constants.bins.maestro }\n        const selectedComboCard = store.get(constants.selectedComboCard)()\n        const isDebitCard = selectedComboCard === constants.comboCards.debit\n        const brand = store.get(constants.selectedBrand)\n        const selectedBrand = this.getBrand(brands, brand)\n\n        const options = { selectedBrand, additionalData: { overwriteBrand: true } }\n\n        eventEmitter.store.emit(constants.comboCardOptions, isDebitCard ? options : {})\n    }\n\n    getOriginKeysSuccessResponse = originKeysRes => {\n        const { origin } = window.location\n        const cart = store.get(constants.cart)\n        const { amount, currencyCode } = cart()\n\n        eventEmitter.store.emit(constants.originKey, originKeysRes.originKeys[origin])\n        store.get(constants.ajax)('paymentMethods', this.getPaymentMethods, {\n            method: 'post',\n            body: { amount: { currency: currencyCode(), value: amount() } },\n        })\n    }\n\n    render = () => {\n        const environment = store.get(constants.environment)\n        const href = constants.adyenCssUrl(environment)\n        const cssLink = `<link rel=\"stylesheet\" href=\"${href}\" />`\n        $('head').append(cssLink)\n\n        store.get(constants.ajax)('originKeys', this.getOriginKeysSuccessResponse)\n    }\n\n    getPaymentMethods = paymentMethodsResponse => {\n        eventEmitter.store.emit(constants.paymentMethodsResponse, paymentMethodsResponse)\n        const environment = store.get(constants.environment)\n        const url = constants.adyenCheckoutComponentUrl(environment)\n\n        const createComponents = () => {\n            createCardCheckout()\n            createLocalPaymentCheckout(paymentMethodsResponse)\n            createBoletoCheckout(paymentMethodsResponse)\n        }\n\n        $.getScript(url, createComponents)\n    }\n}\n\nexport default Component\n","import $ from 'jquery'\nimport ccRestClient from 'ccRestClient'\nimport ccConstants from 'ccConstants'\nimport storageApi from 'storageApi'\nimport pubsub from 'pubsub'\nimport { redirectAuth, createSpinner, getOrderPayload, eventEmitter } from '../utils'\nimport * as constants from '../constants'\nimport { store } from './index'\n\nclass Order {\n    constructor() {\n        this.instance = storageApi.getInstance()\n\n        this.startEventListeners()\n    }\n\n    startEventListeners = () => {\n        eventEmitter.order.on(constants.pageChanged, this.getUrlParametersAndCreateOrder)\n        eventEmitter.order.on(constants.initialOrderCreated, this.initialOrderCreated)\n    }\n\n    initialOrderCreated = orderEvent => {\n        const order = store.get(constants.order)\n        const { customPaymentProperties } = orderEvent.order.payments[0]\n        const { data, resultCode } = customPaymentProperties\n\n        const payload = { order: getOrderPayload(order), customPaymentProperties: JSON.parse(data), resultCode }\n\n        eventEmitter.store.emit(constants.orderPayload, payload)\n        const isDone = store.get(constants.isDone)\n        !isDone() && redirectAuth(payload, this.createOrder)\n    }\n\n    getAndCreatOrder = result => {\n        result.paymentData = this.instance.getItem(constants.storage.paymentData)\n\n        const payment = { type: 'generic', customProperties: result }\n\n        this.recreateOrder(payment)\n    }\n\n    createOrder = orderPayload => {\n        const orderFail = ({ message = 'Failed to create order' } = {}) => {\n            $.Topic(pubsub.topicNames.ORDER_SUBMISSION_FAIL).publish({ message: 'fail', errorMessage: message })\n        }\n\n        const completeOrder = ({ id, uuid }) => {\n            eventEmitter.store.emit(constants.isDone, true)\n            const publishData = { message: 'success', id, uuid }\n            $.Topic(pubsub.topicNames.ORDER_COMPLETED).publish(publishData)\n            $.Topic(pubsub.topicNames.ORDER_SUBMISSION_SUCCESS).publish([publishData])\n        }\n\n        const submitOrder = data => {\n            const orderIsCompleted = orderPayload.op === 'complete'\n            const completedPayload = { ...orderPayload, op: 'complete' }\n            return orderIsCompleted ? completeOrder(data) : this.createOrder(completedPayload)\n        }\n\n        const orderSuccess = data => {\n            const { paymentState, message } = data.payments[0]\n            const { PAYMENT_GROUP_STATE_AUTHORIZED, PAYMENT_GROUP_STATE_INITIAL } = ccConstants\n            const validPaymentGroups = [PAYMENT_GROUP_STATE_AUTHORIZED, PAYMENT_GROUP_STATE_INITIAL]\n            const isValid = validPaymentGroups.includes(paymentState)\n            return isValid ? submitOrder(data) : orderFail({ message, data })\n        }\n\n        ccRestClient.request(ccConstants.ENDPOINT_ORDERS_CREATE_ORDER, orderPayload, orderSuccess, orderFail)\n    }\n\n    recreateOrder = paymentData => {\n        const storedOrder = JSON.parse(this.instance.getItem(constants.storage.order))\n        storedOrder.payments = [paymentData]\n\n        this.createOrder(storedOrder)\n    }\n\n    getResult = urlParameters => {\n        const params = urlParameters.split('&')\n        const formatResult = (acc, param) => {\n            const [key, value] = param.split('=')\n            return { ...acc, [key]: decodeURIComponent(value) }\n        }\n\n        return params.reduce(formatResult, {})\n    }\n\n    getUrlParametersAndCreateOrder = pageData => {\n        const order = store.get(constants.order)\n        const { parameters } = pageData\n\n        if (parameters) {\n            createSpinner()\n\n            const parametersObj = this.getResult(parameters)\n\n            this.cleanPaymentGatewayType(order)\n            this.setAction(parametersObj)\n        }\n    }\n\n    cleanPaymentGatewayType = order => {\n        if (order().paymentGateway()) {\n            order().paymentGateway().type = ''\n        }\n    }\n\n    setAction(parametersObj) {\n        this.isAction = this.hasParameters(parametersObj)\n        this.isAction && this.getAndCreatOrder(parametersObj)\n    }\n    checkIf3ds = parametersObj => 'PaRes' in parametersObj && 'MD' in parametersObj\n    checkIfLocal = parametersObj => 'payload' in parametersObj\n    hasParameters = parametersObj => {\n        const is3DS = this.checkIf3ds(parametersObj)\n        const isLocal = this.checkIfLocal(parametersObj)\n        const hasDetails = is3DS || isLocal\n        return hasDetails\n    }\n}\n\nexport default Order\n","import * as constants from '../constants'\nimport { eventEmitter } from '../utils'\nimport { store } from './index'\n\nclass Payment {\n    constructor() {\n        this.startEventListeners()\n    }\n\n    startEventListeners = () => {\n        eventEmitter.payment.on(constants.setPayment, this.setPayment)\n    }\n\n    setPayment = type => {\n        const order = store.get(constants.order)\n        const id = store.get(constants.id)\n\n        const genericPayment = store.get(constants.genericPayment)\n        const updatedGenericPayment = { ...genericPayment, id: id() }\n\n        eventEmitter.store.emit(constants.genericPayment, updatedGenericPayment)\n        eventEmitter.component.emit(constants.comboCardOptions)\n\n        const payments = [updatedGenericPayment]\n\n        order().updatePayments(payments)\n\n        this.updatePayment(this.createPayment(type))\n    }\n\n    updatePayment = pPayment => {\n        const order = store.get(constants.order)\n        const id = store.get(constants.id)\n\n        const payments = order().payments()\n        const checkId = (curId, id) => curId && curId === id()\n        const setPayments = (payment, index) => {\n            const curPayment = payments[index]\n            const { id: curId } = curPayment\n            const isSameId = checkId(curId, id)\n            return isSameId ? pPayment : curPayment\n        }\n\n        const newPayments = payments.map(setPayments)\n        order().payments(newPayments)\n    }\n\n    createPayment = type => {\n        const storedPaymentType = store.get(constants.storedPaymentType)\n        const isPaymentStored = store.get(constants.isPaymentStored)\n        const paymentDetails = store.get(constants.paymentDetails)\n        const selectedInstallment = store.get(constants.selectedInstallment)\n        const selectedComboCard = store.get(constants.selectedComboCard)\n        const comboCardOptions = store.get(constants.comboCardOptions)\n\n        const hasInstallments = this.checkSelectedInstallment(selectedInstallment)\n\n        const isCreditCard = selectedComboCard() === constants.comboCards.credit\n        const isValid = this.validateInstallment(hasInstallments, isCreditCard)\n\n        const storedPayment = this.getStoredPayment(isPaymentStored, storedPaymentType)\n        const numberOfInstallments = this.getInstallments(isValid, selectedInstallment)\n\n        const genericPayment = store.get(constants.genericPayment)\n        const customProperties = {\n            paymentDetails: paymentDetails[type],\n            storedPayment,\n            ...(numberOfInstallments && { numberOfInstallments }),\n            ...comboCardOptions,\n        }\n        const updatedGenericPayment = { ...genericPayment, customProperties }\n\n        return updatedGenericPayment\n    }\n\n    checkSelectedInstallment = selectedInstallment =>\n        selectedInstallment() && 'numberOfInstallments' in selectedInstallment()\n    getInstallments = (isValid, selectedInstallment) => isValid && parseInt(selectedInstallment().numberOfInstallments)\n    validateInstallment = (hasInstallments, isCreditCard) => hasInstallments && isCreditCard\n    getStoredPayment = (isPaymentStored, storedPaymentType) => (isPaymentStored ? storedPaymentType() : '')\n}\n\nexport default Payment\n","import ko from 'knockout'\nimport { comboCards, noInstallmentsMsg, countries } from '../constants'\nimport { ajax, eventEmitter } from '../utils'\nimport { Component, Order, Payment } from './index'\n\nclass Store {\n    constructor() {\n        this.startEventListeners()\n    }\n\n    brazilEnabled = false\n\n    storedPaymentType = ko.observable('')\n    environment = undefined\n    pageParams = undefined\n\n    // Component\n    component = new Component()\n    checkout = undefined\n    originKey = ''\n    isValid = false\n    selectedBrand = undefined\n    creditCard = comboCards.credit\n    debitCard = comboCards.debit\n    comboCards = ko.observable([comboCards.credit, comboCards.debit])\n    comboCardOptions = {}\n    selectedComboCard = ko.observable(comboCards.credit)\n    isPaymentStored = ko.observable(false)\n    paymentMethodsResponse = undefined\n    paymentDetails = undefined\n    isLoaded = ko.observable(false)\n    installments = ko.observable([])\n    selectedInstallment = ko.observable({})\n    installmentsAllowedCountries = [countries.mexico.locale, countries.brazil.locale]\n    installmentsOptions = []\n\n    // Payment\n    paymentComponent = new Payment()\n    genericPayment = { type: 'generic' }\n\n    // Order\n    orderComponent = new Order()\n    isDone = ko.observable(false)\n\n    // Boleto\n    boletoEnabled = ko.observable(false)\n    boletoDeliveryDate = ''\n    boletoShopperStatement = ''\n\n    // Local\n    checkoutLocal = ko.observable([])\n    localPaymentMethods = ko.observableArray()\n\n    get installmentsEnabled() {\n        const hasInstallments = !!this.installments().length\n        const cardIsCredit = this.selectedComboCard() === comboCards.credit\n        return ko.observable(this.isAllowedCountryForInstallments && hasInstallments && cardIsCredit)\n    }\n\n    get isAllowedCountryForInstallments() {\n        return this.installmentsAllowedCountries.includes(this.locale.toLowerCase())\n    }\n\n    startEventListeners = () => {\n        eventEmitter.store.listen((key, value) => {\n            if (typeof this[key] === 'function') {\n                this[key](value)\n            } else {\n                this[key] = value\n            }\n        })\n    }\n\n    get = key => (this.has(key) ? this[key] : undefined)\n\n    has = key => key in this\n\n    init = viewModel => {\n        this.id = viewModel.id\n        this.order = viewModel.order\n        this.cart = viewModel.cart\n        this.ajax = ajax(viewModel.isPreview())\n        this.translate = viewModel.translate\n        this.locale = viewModel.locale()\n        this.noInstallmentsMsg = viewModel.translate(noInstallmentsMsg)\n    }\n}\n\nexport default new Store()\n","import * as constants from '../../constants'\nimport { addDays, Checkout, createPresentToShopperModal, eventEmitter, createFromAction } from '../../utils'\nimport { store } from '../index'\n\nconst setDeliveryDate = boletoDeliveryDate =>\n    boletoDeliveryDate && eventEmitter.store.emit(constants.boleto.deliveryDate, boletoDeliveryDate)\n\nconst setShopperStatement = boletoShopperStatement =>\n    boletoShopperStatement && eventEmitter.store.emit(constants.boleto.shopperStatement, boletoShopperStatement)\n\nexport const setBoletoConfig = ({ boletoDeliveryDate, boletoShopperStatement }) => {\n    setDeliveryDate(boletoDeliveryDate)\n    setShopperStatement(boletoShopperStatement)\n}\n\nexport const presentToShopper = customPaymentProperties => {\n    const checkoutBoleto = store.get(constants.checkout.boleto)\n    const options = { action: customPaymentProperties, selector: '#present-shopper', checkoutComponent: checkoutBoleto }\n\n    createPresentToShopperModal(() => {\n        createFromAction(options)\n    })\n}\n\nconst setComponent = checkout => eventEmitter.store.emit(constants.checkout.boleto, checkout)\n\nconst createBoletoCheckout = ({ paymentMethods }) => {\n    const hasBoleto = paymentMethods.some(({ type }) => type.includes('boleto'))\n    eventEmitter.store.emit(constants.boleto.enabled, hasBoleto)\n\n    if (hasBoleto) {\n        const checkout = new Checkout(constants.paymentMethodTypes.invoice)\n        const onChange = checkout.onChange({\n            deliveryDate: addDays(store.get(constants.boleto.deliveryDate)),\n            shopperStatement: store.get(constants.boleto.shopperStatement),\n        })\n\n        const onSubmit = checkout.onSubmit()\n\n        const configuration = { onSubmit, onChange }\n        const order = store.get(constants.order)\n\n        const address = order().billingAddress()\n\n        const shopperName = { firstName: address.firstName(), lastName: address.lastName() }\n        const billingAddress = {\n            city: address.city(),\n            country: address.selectedCountry(),\n            // houseNumberOrName:\"952\",\n            postalCode: address.postalCode(),\n            stateOrProvince: address.selectedState(),\n            street: address.address1(),\n        }\n        const options = { data: { shopperName, billingAddress } }\n        const checkoutOptions = { configuration, selector: '#adyen-boleto-payment', type: 'boletobancario', options }\n\n        checkout.createCheckout(checkoutOptions, setComponent)\n    }\n}\n\nexport default createBoletoCheckout\n","import { store } from '../index'\nimport * as constants from '../../constants'\nimport { Checkout, eventEmitter, getInstallmentOptions } from '../../utils'\n\nexport const onBrand = ({ brand }) => {\n    eventEmitter.store.emit(constants.selectedBrand, brand)\n    const installmentsOptions = store.get(constants.installmentsOptions)\n    const cart = store.get(constants.cart)\n    const amount = cart().amount()\n    const installments = installmentsOptions ? getInstallmentOptions(installmentsOptions, amount, brand) : []\n\n    eventEmitter.store.emit(constants.installments, installments)\n}\n\nexport const onConfigSuccess = () => eventEmitter.store.emit(constants.isLoaded, true)\n\nconst createCardCheckout = () => {\n    const checkout = new Checkout(constants.paymentMethodTypes.generic)\n    const onChange = checkout.onChange()\n    const onSubmit = checkout.onSubmit()\n\n    const storedPaymentType = store.get(constants.storedPaymentType)\n    const options = { hasHolderName: false, enableStoreDetails: !!storedPaymentType() }\n\n    const configuration = { onBrand, onConfigSuccess, onChange, onSubmit }\n    const checkoutOptions = { configuration, selector: '#adyen-card-payment', type: 'card', options }\n\n    checkout.createCheckout(checkoutOptions, checkout => {\n        eventEmitter.store.emit(constants.checkout.card, checkout)\n    })\n}\n\nexport default createCardCheckout\n","import * as constants from '../../constants'\nimport { Checkout, eventEmitter } from '../../utils'\n\nconst unsupportedTypes = ['wechatpayWeb', 'scheme', 'boleto', 'boletobancario']\nconst createValidator = paymentMethod => {\n    return {\n        // eslint-disable-next-line complexity\n        validate: (key, value) => {\n            const hasType = 'type' in paymentMethod\n            const isValidType = hasType && !unsupportedTypes.includes(paymentMethod.type)\n            const hasDetails = isValidType && 'details' in paymentMethod\n            const hasOneItem = hasDetails && paymentMethod.details.length === 1\n            const detail = hasOneItem && paymentMethod.details[0]\n            const keyIsIssuerAndTypeIsSelect = detail && detail[key] === value\n            const isValid = !hasDetails || keyIsIssuerAndTypeIsSelect\n            return isValidType && isValid\n        },\n    }\n}\n\nconst isLocalPaymentMethod = paymentMethod => {\n    const { validate } = createValidator(paymentMethod)\n    const keyIsIssuer = validate('key', 'issuer')\n    const typeIsSelect = validate('type', 'select')\n    const isLocal = keyIsIssuer && typeIsSelect\n\n    return isLocal\n}\n\nconst createLocalCheckout = (acc, localPaymentMethod) => {\n    const { type } = localPaymentMethod\n    const checkout = new Checkout(type)\n    const onChange = checkout.onChange()\n    const onSubmit = checkout.onSubmit()\n\n    const configuration = { onSubmit, onChange, showPayButton: true }\n\n    const checkoutOptions = type => ({ configuration, selector: `#adyen-${type}-payment`, type })\n    checkout.createCheckout(checkoutOptions(type), checkout => ({ ...acc, [type]: checkout }))\n}\n\nconst createLocalPaymentCheckout = ({ paymentMethods }) => {\n    const localPaymentMethods = paymentMethods.filter(isLocalPaymentMethod)\n    eventEmitter.store.emit(constants.localPaymentMethods, localPaymentMethods)\n    const localPaymentMethodsCheckout = localPaymentMethods.reduce(createLocalCheckout, {})\n\n    eventEmitter.store.emit(constants.checkout.local, localPaymentMethodsCheckout)\n}\n\nexport default createLocalPaymentCheckout\n","import pubsub from 'pubsub'\nimport notifier from 'notifier'\nimport $ from 'jquery'\nimport { store } from './components'\nimport { createSpinner, destroySpinner, eventEmitter, hideLoaders } from './utils'\nimport createError from './utils/createError'\nimport * as constants from './constants'\nimport { presentToShopper, setBoletoConfig } from './components'\n\nclass ViewModel {\n    store = store\n\n    setGatewaySettings = ({\n        installmentsOptionsId,\n        environment,\n        storedPayment,\n        boletoDeliveryDate,\n        boletoShopperStatement,\n    }) => {\n        eventEmitter.store.emit(constants.environment, environment)\n\n        store.get(constants.isAllowedCountryForInstallments) && this.setInstallments(installmentsOptionsId)\n        eventEmitter.store.emit(constants.storedPaymentType, storedPayment)\n\n        setBoletoConfig({ boletoDeliveryDate: Number(boletoDeliveryDate), boletoShopperStatement })\n    }\n\n    setSiteSettings = () => {\n        this.setSiteCountryAndCurrency()\n\n        const { AdyenGenericGateway } = this.site().extensionSiteSettings\n        this.setGatewaySettings(AdyenGenericGateway)\n    }\n\n    setInstallments = installmentsOptions => {\n        try {\n            eventEmitter.store.emit(constants.installmentsOptions, JSON.parse(installmentsOptions))\n        } catch (e) {\n            const translate = store.get(constants.translate)\n            const { installmentsConfiguration } = constants.errorMessages\n            const errMsg = translate(installmentsConfiguration)\n            notifier.sendError('installments', errMsg, true)\n        }\n    }\n\n    setSiteCountryAndCurrency = () => {\n        const { brazil } = constants.countries\n        const { currency, locale } = brazil\n\n        const siteLocale = store.get(constants.locale).toLowerCase()\n        const currencyCode = this.cart().currencyCode()\n        const localeIsBr = locale === siteLocale\n        const curIsBr = currencyCode.toLowerCase() === currency\n\n        eventEmitter.store.emit(constants.brazilEnabled, localeIsBr && curIsBr)\n    }\n\n    handlePageChanged = pageData => {\n        const isCheckout = pageData.pageId === 'checkout'\n        isCheckout && eventEmitter.order.emit(constants.pageChanged, pageData)\n    }\n\n    beforeAppear = () => {\n        this.reset()\n    }\n\n    onLoad = widget => {\n        store.init(widget)\n        Object.assign(this, widget, { store })\n\n        this.setSiteSettings()\n        this.subscribeToTopics()\n    }\n\n    onRender = () => {\n        eventEmitter.component.emit(constants.render)\n    }\n\n    reset = () => {\n        eventEmitter.store.emit(constants.installments, [])\n    }\n\n    presentToShopper = () => {\n        const { resultCode, customPaymentProperties } = store.get(constants.orderPayload)\n        const isPresentToShopper = resultCode === constants.presentToShopper\n        isPresentToShopper && presentToShopper(customPaymentProperties)\n    }\n    orderSubmitted = () => store.has(constants.orderPayload) && this.presentToShopper()\n\n    subscribeToTopics = () => {\n        const {\n            ORDER_CREATED_INITIAL,\n            ORDER_CREATE,\n            ORDER_SUBMISSION_FAIL,\n            ORDER_COMPLETED,\n            ORDER_CREATED,\n            PAGE_CHANGED,\n            ORDER_SUBMISSION_SUCCESS,\n            NOTIFICATION_ADD,\n        } = pubsub.topicNames\n\n        const emitInitialOrder = ev => {\n            eventEmitter.order.emit(constants.initialOrderCreated, ev)\n        }\n        $.Topic(ORDER_CREATED_INITIAL).subscribe(emitInitialOrder)\n        $.Topic(ORDER_CREATE).subscribe(createSpinner)\n\n        const redirectLink = this.order().checkoutLink\n        const errorCallback = createError({ redirectLink })\n\n        $.Topic(ORDER_SUBMISSION_FAIL).subscribe(errorCallback)\n        $.Topic(ORDER_COMPLETED).subscribe(destroySpinner)\n        $.Topic(ORDER_CREATED).subscribe(this.reset)\n        $.Topic(PAGE_CHANGED).subscribe(this.handlePageChanged)\n        $.Topic(ORDER_SUBMISSION_SUCCESS).subscribe(this.orderSubmitted)\n\n        $.Topic(NOTIFICATION_ADD).subscribe(hideLoaders)\n    }\n}\n\nconst vm = new ViewModel()\nexport default vm\n"],"names":["baseAPIUrl","channels","preview","storefront","errorMessages","paymentRefused","installmentsConfiguration","failed3dsValidation","paymentMethodTypes","generic","invoice","local","adyenUrl","env","toLowerCase","adyenCssUrl","adyenCheckoutComponentUrl","locale","countries","brazil","currency","mexico","brazilEnabled","comboCards","debit","credit","bins","electron","maestro","storage","paymentData","order","noInstallmentsMsg","render","id","checkout","card","boleto","isLoaded","ajax","originKey","installments","cart","setPayment","initialOrderCreated","pageChanged","isAllowedCountryForInstallments","environment","selectedBrand","selectedComboCard","installmentsOptions","storedPaymentType","paymentMethodsResponse","translate","isPaymentStored","paymentDetails","selectedInstallment","comboCardOptions","genericPayment","isDone","isValid","presentToShopper","orderPayload","enabled","deliveryDate","shopperStatement","localPaymentMethods","createSpinner","indicatorOptions","parent","posTop","posLeft","loadingText","$","removeClass","show","spinner","create","destroySpinner","hide","destroy","getData","method","body","data","json","JSON","stringify","isPreview","path","cb","url","headers","channel","success","customPaymentProperties","checkoutCard","store","get","constants","isAuthRedirect","redirect","action","selector","checkoutComponent","instance","storageApi","getInstance","setItem","createFromAction","getOrderPayload","shippingAddressFn","shippingAddress","billingAddressFn","billingAddress","payments","orderProfileId","shippingMethod","shoppingCart","combineLineItems","op","profileId","Emitter","emit","key","value","Topic","publish","listen","subscribe","suffix","event","args","on","_ev","creditCards","name","code","isAllowedCreditCard","creditCard","creditCardSum","parseInt","checkSum","checkAmount","amount","amountRange","validate","hasValidSum","isValidAmount","getInstallmentOptions","brand","find","createInstallmentsObj","item","numberOfInstallments","map","filter","valid","getDefaultConfig","showPayButton","mount","Checkout","type","configuration","options","defaultConfiguration","AdyenCheckout","loader","document","querySelector","classList","toggle","eventEmitter","payment","ccConstants","ORDER_OP_INITIATE","handlePlaceOrder","state","component","payload","createPresentToShopperModal","node","createElement","setAttribute","wrapper","modal","clickEvent","removeEventListener","remove","addEventListener","innerHTML","appendChild","createError","preserveUrl","errorMessage","navigation","goTo","redirectLink","notifier","sendError","addDays","days","Date","setDate","getDate","hideLoaders","toggleElementAttribute","el","querySelectorAll","forEach","Component","getComboCardOptions","brands","visa","mastercard","isDebitCard","getBrand","additionalData","overwriteBrand","originKeysRes","origin","window","location","currencyCode","originKeys","getPaymentMethods","href","cssLink","append","getOriginKeysSuccessResponse","createComponents","createCardCheckout","createLocalPaymentCheckout","createBoletoCheckout","getScript","startEventListeners","Order","getUrlParametersAndCreateOrder","orderEvent","resultCode","parse","redirectAuth","createOrder","result","getItem","customProperties","recreateOrder","orderFail","message","pubsub","topicNames","ORDER_SUBMISSION_FAIL","completeOrder","uuid","publishData","ORDER_COMPLETED","ORDER_SUBMISSION_SUCCESS","submitOrder","orderIsCompleted","completedPayload","orderSuccess","paymentState","PAYMENT_GROUP_STATE_AUTHORIZED","PAYMENT_GROUP_STATE_INITIAL","validPaymentGroups","includes","ccRestClient","request","ENDPOINT_ORDERS_CREATE_ORDER","storedOrder","urlParameters","params","split","formatResult","acc","param","decodeURIComponent","reduce","pageData","parameters","parametersObj","getResult","cleanPaymentGatewayType","setAction","paymentGateway","is3DS","checkIf3ds","isLocal","checkIfLocal","hasDetails","isAction","hasParameters","getAndCreatOrder","Payment","updatedGenericPayment","updatePayments","updatePayment","createPayment","pPayment","checkId","curId","setPayments","index","curPayment","isSameId","newPayments","hasInstallments","checkSelectedInstallment","isCreditCard","validateInstallment","storedPayment","getStoredPayment","getInstallments","Store","ko","observable","undefined","observableArray","has","viewModel","length","cardIsCredit","installmentsAllowedCountries","setDeliveryDate","boletoDeliveryDate","setShopperStatement","boletoShopperStatement","setBoletoConfig","checkoutBoleto","setComponent","paymentMethods","hasBoleto","some","onChange","onSubmit","address","shopperName","firstName","lastName","city","country","selectedCountry","postalCode","stateOrProvince","selectedState","street","address1","checkoutOptions","createCheckout","onBrand","onConfigSuccess","hasHolderName","enableStoreDetails","unsupportedTypes","createValidator","paymentMethod","hasType","isValidType","hasOneItem","details","detail","keyIsIssuerAndTypeIsSelect","isLocalPaymentMethod","keyIsIssuer","typeIsSelect","createLocalCheckout","localPaymentMethod","localPaymentMethodsCheckout","ViewModel","installmentsOptionsId","setInstallments","Number","setSiteCountryAndCurrency","AdyenGenericGateway","site","extensionSiteSettings","setGatewaySettings","e","errMsg","siteLocale","localeIsBr","curIsBr","isCheckout","pageId","reset","widget","init","Object","assign","setSiteSettings","subscribeToTopics","isPresentToShopper","ORDER_CREATED_INITIAL","ORDER_CREATE","ORDER_CREATED","PAGE_CHANGED","NOTIFICATION_ADD","emitInitialOrder","ev","checkoutLink","errorCallback","handlePageChanged","orderSubmitted","vm"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAO,IAAMA,UAAU,GAAG,2BAAnB;AACP,EAAO,IAAMC,QAAQ,GAAG;EAAEC,EAAAA,OAAO,EAAE,SAAX;EAAsBC,EAAAA,UAAU,EAAE;EAAlC,CAAjB;AACP,EAAO,IAAMC,aAAa,GAAG;EACzBC,EAAAA,cAAc,EAAE,gBADS;EAEzBC,EAAAA,yBAAyB,EAAE,2BAFF;EAGzBC,EAAAA,mBAAmB,EAAE;EAHI,CAAtB;AAKP,EAAO,IAAMC,kBAAkB,GAAG;EAC9BC,EAAAA,OAAO,EAAE,SADqB;EAE9BC,EAAAA,OAAO,EAAE,SAFqB;EAG9BC,EAAAA,KAAK,EAAE;EAHuB,CAA3B;AAKP,EAAO,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAAAC,GAAG;EAAA,2CAA+BA,GAAG,CAACC,WAAJ,EAA/B;EAAA,CAApB;AACP,EAAO,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAAAF,GAAG;EAAA,mBAAOD,QAAQ,CAACC,GAAD,CAAf;EAAA,CAAvB;AACP,EAAO,IAAMG,yBAAyB,GAAG,SAA5BA,yBAA4B,CAAAH,GAAG;EAAA,mBAAOD,QAAQ,CAACC,GAAD,CAAf;EAAA,CAArC;AAEP,EAAO,IAAMI,MAAM,GAAG,QAAf;AACP,EAAO,IAAMC,SAAS,GAAG;EACrBC,EAAAA,MAAM,EAAE;EAAEF,IAAAA,MAAM,EAAE,OAAV;EAAmBG,IAAAA,QAAQ,EAAE;EAA7B,GADa;EAErBC,EAAAA,MAAM,EAAE;EAAEJ,IAAAA,MAAM,EAAE,OAAV;EAAmBG,IAAAA,QAAQ,EAAE;EAA7B;EAFa,CAAlB;AAIP,EAAO,IAAME,aAAa,GAAG,eAAtB;AACP,EAAO,IAAMC,UAAU,GAAG;EAAEC,EAAAA,KAAK,EAAE,WAAT;EAAsBC,EAAAA,MAAM,EAAE;EAA9B,CAAnB;AACP,EAAO,IAAMC,IAAI,GAAG;EAAEC,EAAAA,QAAQ,EAAE,UAAZ;EAAwBC,EAAAA,OAAO,EAAE;EAAjC,CAAb;AACP,EAAO,IAAMC,OAAO,GAAG;EAAEC,EAAAA,WAAW,EAAE,kBAAf;EAAmCC,EAAAA,KAAK,EAAE;EAA1C,CAAhB;AACP,EAAO,IAAMC,iBAAiB,GAAG,mBAA1B;AAEP,EAAO,IAAMC,MAAM,GAAG,QAAf;AACP,EAAO,IAAMC,EAAE,GAAG,IAAX;AACP,EAAO,IAAMH,KAAK,GAAG,OAAd;AACP,EAAO,IAAMI,QAAQ,GAAG;EACpBC,EAAAA,IAAI,EAAE,cADc;EAEpBC,EAAAA,MAAM,EAAE,gBAFY;EAGpB1B,EAAAA,KAAK,EAAE;EAHa,CAAjB;AAKP,EAAO,IAAM2B,QAAQ,GAAG,UAAjB;AACP,EAAO,IAAMC,IAAI,GAAG,MAAb;AACP,EAAO,IAAMC,SAAS,GAAG,WAAlB;AACP,EAAO,IAAMC,YAAY,GAAG,cAArB;AACP,EAAO,IAAMC,IAAI,GAAG,MAAb;AACP,EAAO,IAAMC,UAAU,GAAG,YAAnB;AACP,EACO,IAAMC,mBAAmB,GAAG,qBAA5B;AACP,EAAO,IAAMC,WAAW,GAAG,aAApB;AACP,EACO,IAAMC,+BAA+B,GAAG,iCAAxC;AACP,EAAO,IAAMC,WAAW,GAAG,aAApB;AACP,EAAO,IAAMC,aAAa,GAAG,eAAtB;AACP,EAAO,IAAMC,iBAAiB,GAAG,mBAA1B;AACP,EAAO,IAAMC,mBAAmB,GAAG,oBAA5B;AACP,EAAO,IAAMC,iBAAiB,GAAG,mBAA1B;AACP,EAAO,IAAMC,sBAAsB,GAAG,wBAA/B;AACP,EAAO,IAAMC,SAAS,GAAG,WAAlB;AACP,EAAO,IAAMC,eAAe,GAAG,iBAAxB;AACP,EAAO,IAAMC,cAAc,GAAG,gBAAvB;AACP,EAAO,IAAMC,mBAAmB,GAAG,qBAA5B;AACP,EAAO,IAAMC,gBAAgB,GAAG,kBAAzB;AACP,EAAO,IAAMC,cAAc,GAAG,gBAAvB;AACP,EAAO,IAAMC,MAAM,GAAG,QAAf;AACP,EAAO,IAAMC,OAAO,GAAG,SAAhB;AACP,EACO,IAAMC,gBAAgB,GAAG,kBAAzB;AACP,EAAO,IAAMC,YAAY,GAAG,cAArB;AACP,EAAO,IAAMzB,MAAM,GAAG;EAClB0B,EAAAA,OAAO,EAAE,eADS;EAElBC,EAAAA,YAAY,EAAE,oBAFI;EAGlBC,EAAAA,gBAAgB,EAAE;EAHA,CAAf;AAKP,EAAO,IAAMC,mBAAmB,GAAG,qBAA5B;;ECjEA,IAAMC,aAAa,GAAG,SAAhBA,aAAgB,GAAM;EAC/B,MAAMC,gBAAgB,GAAG;EACrBC,IAAAA,MAAM,EAAE,eADa;EAErBC,IAAAA,MAAM,EAAE,KAFa;EAGrBC,IAAAA,OAAO,EAAE,KAHY;EAIrBC,IAAAA,WAAW,EAAE;EAJQ,GAAzB;EAMAC,EAAAA,CAAC,CAAC,eAAD,CAAD,CAAmBC,WAAnB,CAA+B,MAA/B;EACAD,EAAAA,CAAC,CAAC,eAAD,CAAD,CAAmBE,IAAnB;EACAC,EAAAA,OAAO,CAACC,MAAR,CAAeT,gBAAf;EACH,CAVM;AAYP,EAAO,IAAMU,cAAc,GAAG,SAAjBA,cAAiB,GAAM;EAChCL,EAAAA,CAAC,CAAC,eAAD,CAAD,CAAmBM,IAAnB;EACAH,EAAAA,OAAO,CAACI,OAAR;EACH,CAHM;;ECZP,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACC,MAAD,EAASC,IAAT;EAAA,SAAkBD,MAAM,KAAK,MAAX,IAAqB;EAAEE,IAAAA,IAAI,EAAE;EAAEC,MAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAeJ,IAAf;EAAR;EAAR,GAAvC;EAAA,CAAhB;AACA,gBAAe,UAAAK,SAAS,EAAI;EACxB,SAAO,UAACC,IAAD,EAAOC,EAAP,EAA8D;EAAA,mFAAhC;EAAEP,MAAAA,IAAI,EAAE,EAAR;EAAYD,MAAAA,MAAM,EAAE;EAApB,KAAgC;EAAA,QAAjDC,IAAiD,QAAjDA,IAAiD;EAAA,QAA3CD,MAA2C,QAA3CA,MAA2C;EACjE,QAAME,IAAI,GAAGH,OAAO,CAACC,MAAD,EAASC,IAAT,CAApB;EACAV,IAAAA,CAAC,CAAClC,IAAF;EACIoD,MAAAA,GAAG,YAAK3F,UAAL,cAAmByF,IAAnB,CADP;EAEIP,MAAAA,MAAM,EAANA,MAFJ;EAGIU,MAAAA,OAAO,EAAE;EACL,yCAAiC,QAD5B;EAELC,QAAAA,OAAO,EAAEL,SAAS,GAAGvF,QAAQ,CAACC,OAAZ,GAAsBD,QAAQ,CAACE;EAF5C,OAHb;EAOI2F,MAAAA,OAAO,EAAEJ;EAPb,OAQON,IARP;EAUH,GAZD;EAaH,CAdD;;ACCA,sBAAe,gBAAqCM,EAArC,EAA4C;EAAA,MAAzC3D,KAAyC,QAAzCA,KAAyC;EAAA,MAAlCgE,uBAAkC,QAAlCA,uBAAkC;EACvD,MAAMC,YAAY,GAAGC,KAAK,CAACC,GAAN,CAAUC,QAAA,CAAmB/D,IAA7B,CAArB;EACA,MAAMgE,cAAc,GAAG,iBAAiBL,uBAAxC;EACA,MAAMM,QAAQ,GAAG,SAAXA,QAAW,GAAM;EACnB,QAAMC,MAAM,GAAG;EACXA,MAAAA,MAAM,EAAEP,uBADG;EAEXQ,MAAAA,QAAQ,EAAE,qBAFC;EAGXC,MAAAA,iBAAiB,EAAER;EAHR,KAAf;EAMA,QAAMS,QAAQ,GAAGC,UAAU,CAACC,WAAX,EAAjB;EACAF,IAAAA,QAAQ,CAACG,OAAT,CAAiBT,OAAA,CAAkBrE,WAAnC,EAAgDiE,uBAAuB,CAACjE,WAAxE;EACA2E,IAAAA,QAAQ,CAACG,OAAT,CAAiBT,OAAA,CAAkBpE,KAAnC,EAA0CuD,IAAI,CAACC,SAAL,CAAexD,KAAf,CAA1C;EAEA8E,IAAAA,gBAAgB,CAACP,MAAD,CAAhB;EACH,GAZD;EAcAF,EAAAA,cAAc,GAAGC,QAAQ,EAAX,GAAgBX,EAAE,CAAC3D,KAAD,CAAhC;EACH,CAlBD;;ECLe,SAAS+E,eAAT,CAAyB/E,KAAzB,EAAgC;EAAA,eACsDA,KAAK,EAD3D;EAAA,MAClBgF,iBADkB,UACnCC,eADmC;EAAA,MACiBC,gBADjB,UACCC,cADD;EAAA,MACmCxE,IADnC,UACmCA,IADnC;EAAA,MACyCyE,QADzC,UACyCA,QADzC;EAAA,qBAGmDpF,KAAK,GAAGA,KAAR,EAHnD;EAAA,MAGnCmF,cAHmC,gBAGnCA,cAHmC;EAAA,MAGnBF,eAHmB,gBAGnBA,eAHmB;EAAA,MAGF9E,EAHE,gBAGFA,EAHE;EAAA,MAGEkF,cAHF,gBAGEA,cAHF;EAAA,MAGkBC,cAHlB,gBAGkBA,cAHlB;EAAA,MAGkCC,YAHlC,gBAGkCA,YAHlC;EAK3C,SAAO;EACHJ,IAAAA,cAAc,qBACPD,gBAAgB,EADT,MAEPC,cAFO,CADX;EAKHK,IAAAA,gBAAgB,EAAE7E,IAAI,GAAG6E,gBALtB;EAMHC,IAAAA,EAAE,EAAE,UAND;EAOHtF,IAAAA,EAAE,EAAFA,EAPG;EAQHiF,IAAAA,QAAQ,EAAEA,QAAQ,EARf;EASHM,IAAAA,SAAS,EAAEL,cATR;EAUHJ,IAAAA,eAAe,qBACRD,iBAAiB,EADT,MAERC,eAFQ,CAVZ;EAcHK,IAAAA,cAAc,EAAdA,cAdG;EAeHC,IAAAA,YAAY,EAAZA;EAfG,GAAP;EAiBH;;MCpBKI;;mCACM;EACJC,IAAAA,IAAI,EAAE,cAACC,GAAD,EAAMC,KAAN;EAAA,aAAgBpD,CAAC,CAACqD,KAAF,CAAQ,OAAR,EAAiBC,OAAjB,CAAyBH,GAAzB,EAA8BC,KAA9B,CAAhB;EAAA,KADF;EAEJG,IAAAA,MAAM,EAAE,gBAAAtC,EAAE;EAAA,aAAIjB,CAAC,CAACqD,KAAF,CAAQ,OAAR,EAAiBG,SAAjB,CAA2BvC,EAA3B,CAAJ;EAAA;EAFN;iCAKF,UAAAwC,MAAM;EAAA,WAAK;EACbP,MAAAA,IAAI,EAAE,cAACQ,KAAD;EAAA;EAAA,0CAAWC,IAAX;EAAWA,UAAAA,IAAX;EAAA;EAAA,eAAoB,YAAA3D,CAAC,CAACqD,KAAF,WAAWI,MAAX,cAAqBC,KAArB,IAA8BJ,OAA9B,iBAAyCK,IAAzC,CAApB;EAAA,OADO;EAEbC,MAAAA,EAAE,EAAE,YAACF,KAAD,EAAQzC,EAAR;EAAA,eAAejB,CAAC,CAACqD,KAAF,WAAWI,MAAX,cAAqBC,KAArB,GAA8BF,SAA9B,CAAwCvC,EAAxC,CAAf;EAAA;EAFS,KAAL;EAAA;kCAKL,UAACkC,GAAD;EAAA;EAAA,uCAASQ,IAAT;EAASA,MAAAA,IAAT;EAAA;EAAA,WAAkB,aAAA3D,CAAC,CAACqD,KAAF,CAAQF,GAAR,GAAaG,OAAb,kBAAwBK,IAAxB,CAAlB;EAAA;qCAEG,KAAKE,GAAL,CAAS,SAAT;mCACF,KAAKA,GAAL,CAAS,OAAT;uCACI,KAAKA,GAAL,CAAS,WAAT;gCAEP,UAACH,KAAD,EAAQzC,EAAR;EAAA,WAAejB,CAAC,CAACqD,KAAF,CAAQK,KAAR,EAAeF,SAAf,CAAyBvC,EAAzB,CAAf;EAAA;;AAGT,qBAAe,IAAIgC,OAAJ,EAAf;;ECtBA,IAAMa,WAAW,GAAG,CAChB;EAAErG,EAAAA,EAAE,EAAE,CAAN;EAASsG,EAAAA,IAAI,EAAE,MAAf;EAAuBC,EAAAA,IAAI,EAAE;EAA7B,CADgB;EAYhB;EAAEvG,EAAAA,EAAE,EAAE,CAAN;EAASsG,EAAAA,IAAI,EAAE,KAAf;EAAsBC,EAAAA,IAAI,EAAE;EAA5B,CAZgB;EAchB;EAAEvG,EAAAA,EAAE,EAAE,CAAN;EAASsG,EAAAA,IAAI,EAAE,WAAf;EAA4BC,EAAAA,IAAI,EAAE;EAAlC,CAdgB,EAehB;EAAEvG,EAAAA,EAAE,EAAE,CAAN;EAASsG,EAAAA,IAAI,EAAE,WAAf;EAA4BC,EAAAA,IAAI,EAAE;EAAlC,CAfgB;EAqBhB;EAAEvG,EAAAA,EAAE,EAAE,CAAN;EAASsG,EAAAA,IAAI,EAAE,YAAf;EAA6BC,EAAAA,IAAI,EAAE;EAAnC,CArBgB;EA8BhB;EAAEvG,EAAAA,EAAE,EAAE,EAAN;EAAUsG,EAAAA,IAAI,EAAE,MAAhB;EAAwBC,EAAAA,IAAI,EAAE;EAA9B,CA9BgB;EAAA,CAApB;EAoCA,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,UAAD,EAAaC,aAAb;EAAA,SAA+B,CAACC,QAAQ,CAACD,aAAD,CAAR,GAA0BD,UAAU,CAACzG,EAAtC,MAA8C,CAA7E;EAAA,CAA5B;EACA,IAAM4G,QAAQ,GAAG,SAAXA,QAAW,CAACH,UAAD,EAAaC,aAAb;EAAA,SAA+BD,UAAU,IAAID,mBAAmB,CAACC,UAAD,EAAaC,aAAb,CAAhE;EAAA,CAAjB;EACA,IAAMG,WAAW,GAAG,SAAdA,WAAc,CAACC,MAAD,EAASC,WAAT;EAAA,SAAyBD,MAAM,IAAIC,WAAnC;EAAA,CAApB;EACA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACC,WAAD,EAAcC,aAAd;EAAA,SAAgCD,WAAW,IAAIC,aAA/C;EAAA,CAAjB;EAEA,SAASC,qBAAT,CAA+BnG,mBAA/B,EAAoD8F,MAApD,EAA4DM,KAA5D,EAAmE;EAC/D,MAAMX,UAAU,GAAGJ,WAAW,CAACgB,IAAZ,CAAiB;EAAA,QAAGd,IAAH,QAAGA,IAAH;EAAA,WAAca,KAAK,KAAKb,IAAxB;EAAA,GAAjB,CAAnB;EACA,MAAMe,qBAAqB,GAAG,SAAxBA,qBAAwB,CAAAC,IAAI,EAAI;EAAA,+BACyBA,IADzB;EAAA,QAC3BR,WAD2B;EAAA,QACdS,oBADc;EAAA,QACQd,aADR;EAElC,QAAMO,WAAW,GAAGL,QAAQ,CAACH,UAAD,EAAaC,aAAb,CAA5B;EACA,QAAMQ,aAAa,GAAGL,WAAW,CAACC,MAAD,EAASC,WAAT,CAAjC;EACA,QAAMrF,OAAO,GAAGsF,QAAQ,CAACC,WAAD,EAAcC,aAAd,CAAxB;EAEA,WAAOxF,OAAO,IAAI;EAAE8F,MAAAA,oBAAoB,EAApBA;EAAF,KAAlB;EACH,GAPD;EASA,SAAOxG,mBAAmB,CAACyG,GAApB,CAAwBH,qBAAxB,EAA+C,EAA/C,EAAmDI,MAAnD,CAA0D,UAAAC,KAAK;EAAA,WAAIA,KAAJ;EAAA,GAA/D,CAAP;EACH;;EChDM,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;EAClC,MAAM/G,aAAW,GAAGkD,KAAK,CAACC,GAAN,CAAUC,WAAV,CAApB;EACA,MAAMlF,QAAM,GAAGgF,KAAK,CAACC,GAAN,CAAUC,MAAV,CAAf;EACA,MAAM3D,WAAS,GAAGyD,KAAK,CAACC,GAAN,CAAUC,SAAV,CAAlB;EACA,MAAM/C,wBAAsB,GAAG6C,KAAK,CAACC,GAAN,CAAUC,sBAAV,CAA/B;EAEA,SAAO;EACH4D,IAAAA,aAAa,EAAE,IADZ;EAEH9I,IAAAA,MAAM,EAANA,QAFG;EAGH8B,IAAAA,WAAW,EAAEA,aAAW,CAACjC,WAAZ,EAHV;EAIH0B,IAAAA,SAAS,EAATA,WAJG;EAKHY,IAAAA,sBAAsB,EAAtBA;EALG,GAAP;EAOH,CAbM;AAeP,EAAO,IAAMyD,gBAAgB,GAAG,SAAnBA,gBAAmB,OAA6C;EAAA,MAA1CP,MAA0C,QAA1CA,MAA0C;EAAA,MAAlCC,QAAkC,QAAlCA,QAAkC;EAAA,MAAxBC,iBAAwB,QAAxBA,iBAAwB;EACzEA,EAAAA,iBAAiB,CAACK,gBAAlB,CAAmCP,MAAnC,EAA2C0D,KAA3C,CAAiDzD,QAAjD;EACH,CAFM;MAID0D,WACF,kBAAYC,KAAZ,EAAkB;EAAA;EAAA;EAAA,0CAID,iBAAkDxE,EAAlD,EAAyD;EAAA,QAAtDyE,aAAsD,SAAtDA,aAAsD;EAAA,QAAvC5D,QAAuC,SAAvCA,QAAuC;EAAA,QAA7B2D,IAA6B,SAA7BA,IAA6B;EAAA,8BAAvBE,OAAuB;EAAA,QAAvBA,OAAuB,8BAAb,EAAa;EACtE,QAAMC,oBAAoB,GAAGP,gBAAgB,EAA7C,CADsE;EAGtE,QAAM3H,QAAQ,GAAG,IAAImI,aAAJ,oBAAuBD,oBAAvB,MAAgDF,aAAhD,EAAjB;EACAhI,IAAAA,QAAQ,CAAC0C,MAAT,CAAgBqF,IAAhB,EAAsBE,OAAtB,EAA+BJ,KAA/B,CAAqCzD,QAArC;EAEAb,IAAAA,EAAE,CAACvD,QAAD,CAAF;EACH,GAXiB;EAAA,oCAaP;EAAA,WAAM,YAAM;EACnB,UAAMoI,MAAM,GAAGC,QAAQ,CAACC,aAAT,kBAAiC,KAAI,CAACP,IAAtC,8BAAf;EACAK,MAAAA,MAAM,IAAIA,MAAM,CAACG,SAAP,CAAiBC,MAAjB,CAAwB,MAAxB,EAAgC,KAAhC,CAAV;EAEA,UAAM5I,OAAK,GAAGkE,KAAK,CAACC,GAAN,CAAUC,KAAV,CAAd;EACAyE,MAAAA,YAAY,CAACC,OAAb,CAAqBlD,IAArB,CAA0BxB,UAA1B,EAAgD,KAAI,CAAC+D,IAArD;EAEAnI,MAAAA,OAAK,GAAGG,EAAR,CAAW,IAAX;EACAH,MAAAA,OAAK,GAAGyF,EAAR,CAAWsD,WAAW,CAACC,iBAAvB;EACAhJ,MAAAA,OAAK,GAAGiJ,gBAAR;EACH,KAVU;EAAA,GAbO;EAAA,oCAyBP,UAAAZ,OAAO;EAAA,WAAI,UAACa,KAAD,EAAQC,SAAR,EAAsB;EACxC,UAAM3H,gBAAc,GAAG0C,KAAK,CAACC,GAAN,CAAUC,cAAV,CAAvB;EACA,UAAMvC,SAAO,GAAGsH,SAAS,CAACtH,OAAV,IAAqB,QAAOqH,KAAK,CAAC7F,IAAb,MAAsB,QAA3D;EACAwF,MAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,OAAxB,EAA2CvC,SAA3C;EAEA,UAAMuH,OAAO,sBAAQ5H,gBAAR,sBAAyB,KAAI,CAAC2G,IAA9B,qBAA0Ce,KAAK,CAAC7F,IAAhD,MAAyDgF,OAAzD,GAAb;EAEAQ,MAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,cAAxB,EAAkDgF,OAAlD;EACH,KARiB;EAAA,GAzBA;EACd,OAAKjB,IAAL,GAAYA,KAAZ;EACH;;ECxBE,IAAMkB,2BAA2B,GAAG,SAA9BA,2BAA8B,CAAA1F,EAAE,EAAI;EAC7C,MAAM2F,IAAI,GAAGb,QAAQ,CAACc,aAAT,CAAuB,KAAvB,CAAb;EACAD,EAAAA,IAAI,CAACE,YAAL,CACI,OADJ,EAEI,qGACI,sBAHR;EAMA,MAAMC,OAAO,GAAGhB,QAAQ,CAACc,aAAT,CAAuB,KAAvB,CAAhB;EACAE,EAAAA,OAAO,CAACD,YAAR,CAAqB,OAArB,EAA8B,yEAA9B;EACAC,EAAAA,OAAO,CAACD,YAAR,CAAqB,IAArB,EAA2B,yBAA3B;EAEA,MAAME,KAAK,GAAGjB,QAAQ,CAACc,aAAT,CAAuB,KAAvB,CAAd;EACAG,EAAAA,KAAK,CAACF,YAAN,CAAmB,IAAnB,EAAyB,iBAAzB;EACAE,EAAAA,KAAK,CAACF,YAAN,CAAmB,OAAnB,EAA4B,mCAA5B;EAEA,MAAMG,UAAU,GAAG,SAAbA,UAAa,GAAM;EACrBF,IAAAA,OAAO,CAACG,mBAAR,CAA4B,OAA5B,EAAqCD,UAArC;EACAL,IAAAA,IAAI,CAACO,MAAL;EACH,GAHD;EAKAJ,EAAAA,OAAO,CAACK,gBAAR,CAAyB,OAAzB,EAAkCH,UAAlC;EAEA,MAAM3I,aAAW,GAAGkD,KAAK,CAACC,GAAN,CAAUC,WAAV,CAApB;EAEAkF,EAAAA,IAAI,CAACS,SAAL,yFAEoC/I,aAFpC;EAKAsI,EAAAA,IAAI,CAACU,WAAL,CAAiBN,KAAjB;EACAJ,EAAAA,IAAI,CAACU,WAAL,CAAiBP,OAAjB;EAEAhB,EAAAA,QAAQ,CAACrF,IAAT,CAAc4G,WAAd,CAA0BV,IAA1B;EACA3F,EAAAA,EAAE,CAAC2F,IAAD,CAAF;EACH,CAnCM;;ECCP,IAAMW,WAAW,GAAG,SAAdA,WAAc,CAAC5B,OAAD;EAAA,MAAU6B,WAAV,uEAAwB,KAAxB;EAAA,SAAkC,YAAuD;EAAA,mFAAP,EAAO;EAAA,iCAApDC,YAAoD;EAAA,QAApDA,YAAoD,kCAArC,yBAAqC;EACzG,sBAAkB9B,OAAlB,IAA6B+B,UAAU,CAACC,IAAX,CAAgBhC,OAAO,CAACiC,YAAxB,EAAsCJ,WAAtC,CAA7B;EACAnH,IAAAA,cAAc;EACdwH,IAAAA,QAAQ,CAACC,SAAT,CAAmB,OAAnB,EAA4BL,YAA5B,EAA0C,IAA1C;EACH,GAJmB;EAAA,CAApB;;ECJO,IAAMM,OAAO,GAAG,SAAVA,OAAU,CAAAC,IAAI;EAAA,SAAI,IAAIC,IAAJ,GAAWC,OAAX,CAAmB,IAAID,IAAJ,GAAWE,OAAX,KAAuBH,IAA1C,CAAJ;EAAA,CAApB;;ECAP,IAAMI,WAAW,GAAG,SAAdA,WAAc,GAAM;EACtB,MAAMC,sBAAsB,GAAG,SAAzBA,sBAAyB,CAAAC,EAAE;EAAA,WAAIA,EAAE,CAACrC,SAAH,CAAaC,MAAb,CAAoB,MAApB,EAA4B,IAA5B,CAAJ;EAAA,GAAjC;EACAH,EAAAA,QAAQ,CAACwC,gBAAT,CAA0B,iBAA1B,EAA6CC,OAA7C,CAAqDH,sBAArD;EACH,CAHD;;MCKMI,YACF,qBAAc;EAAA;EAAA;EAAA,+CAIQ,YAAM;EACxBtC,IAAAA,YAAY,CAACM,SAAb,CAAuB7C,EAAvB,CAA0BlC,MAA1B,EAA4C,KAAI,CAAClE,MAAjD;EACA2I,IAAAA,YAAY,CAACM,SAAb,CAAuB7C,EAAvB,CAA0BlC,gBAA1B,EAAsD,KAAI,CAACgH,mBAA3D;EACH,GAPa;EAAA,oCASH,UAACC,MAAD,EAAS9D,KAAT;EAAA,WACPA,KAAK,IAAI8D,MAAT,GAAkBA,MAAM,CAACnH,KAAK,CAACC,GAAN,CAAUC,aAAV,CAAD,CAAxB,GAA+DF,KAAK,CAACC,GAAN,CAAUC,aAAV,CADxD;EAAA,GATG;EAAA,+CAWQ,YAAM;EACxB,QAAMiH,MAAM,GAAG;EAAEC,MAAAA,IAAI,EAAElH,IAAA,CAAexE,QAAvB;EAAiC2L,MAAAA,UAAU,EAAEnH,IAAA,CAAevE;EAA5D,KAAf;EACA,QAAMqB,mBAAiB,GAAGgD,KAAK,CAACC,GAAN,CAAUC,iBAAV,GAA1B;EACA,QAAMoH,WAAW,GAAGtK,mBAAiB,KAAKkD,UAAA,CAAqB3E,KAA/D;EACA,QAAM8H,KAAK,GAAGrD,KAAK,CAACC,GAAN,CAAUC,aAAV,CAAd;EACA,QAAMnD,eAAa,GAAG,KAAI,CAACwK,QAAL,CAAcJ,MAAd,EAAsB9D,KAAtB,CAAtB;EAEA,QAAMc,OAAO,GAAG;EAAEpH,MAAAA,aAAa,EAAbA,eAAF;EAAiByK,MAAAA,cAAc,EAAE;EAAEC,QAAAA,cAAc,EAAE;EAAlB;EAAjC,KAAhB;EAEA9C,IAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,gBAAxB,EAAoDoH,WAAW,GAAGnD,OAAH,GAAa,EAA5E;EACH,GArBa;EAAA,wDAuBiB,UAAAuD,aAAa,EAAI;EAAA,QACpCC,MADoC,GACzBC,MAAM,CAACC,QADkB,CACpCF,MADoC;EAE5C,QAAMlL,MAAI,GAAGuD,KAAK,CAACC,GAAN,CAAUC,IAAV,CAAb;EAF4C,gBAGXzD,MAAI,EAHO;EAAA,QAGpCsG,MAHoC,SAGpCA,MAHoC;EAAA,QAG5B+E,YAH4B,SAG5BA,YAH4B;EAK5CnD,IAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,SAAxB,EAA6CwH,aAAa,CAACK,UAAd,CAAyBJ,MAAzB,CAA7C;EACA3H,IAAAA,KAAK,CAACC,GAAN,CAAUC,IAAV,EAA0B,gBAA1B,EAA4C,KAAI,CAAC8H,iBAAjD,EAAoE;EAChE/I,MAAAA,MAAM,EAAE,MADwD;EAEhEC,MAAAA,IAAI,EAAE;EAAE6D,QAAAA,MAAM,EAAE;EAAE5H,UAAAA,QAAQ,EAAE2M,YAAY,EAAxB;EAA4BlG,UAAAA,KAAK,EAAEmB,MAAM;EAAzC;EAAV;EAF0D,KAApE;EAIH,GAjCa;EAAA,kCAmCL,YAAM;EACX,QAAMjG,aAAW,GAAGkD,KAAK,CAACC,GAAN,CAAUC,WAAV,CAApB;EACA,QAAM+H,IAAI,GAAG/H,WAAA,CAAsBpD,aAAtB,CAAb;EACA,QAAMoL,OAAO,6CAAmCD,IAAnC,UAAb;EACAzJ,IAAAA,CAAC,CAAC,MAAD,CAAD,CAAU2J,MAAV,CAAiBD,OAAjB;EAEAlI,IAAAA,KAAK,CAACC,GAAN,CAAUC,IAAV,EAA0B,YAA1B,EAAwC,KAAI,CAACkI,4BAA7C;EACH,GA1Ca;EAAA,6CA4CM,UAAAjL,wBAAsB,EAAI;EAC1CwH,IAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,sBAAxB,EAA0D/C,wBAA1D;EACA,QAAML,aAAW,GAAGkD,KAAK,CAACC,GAAN,CAAUC,WAAV,CAApB;EACA,QAAMR,GAAG,GAAGQ,yBAAA,CAAoCpD,aAApC,CAAZ;EAEA,QAAMuL,gBAAgB,GAAG,SAAnBA,gBAAmB,GAAM;EAC3BC,MAAAA,kBAAkB;EAClBC,MAAAA,0BAA0B,CAACpL,wBAAD,CAA1B;EACAqL,MAAAA,oBAAoB,CAACrL,wBAAD,CAApB;EACH,KAJD;EAMAqB,IAAAA,CAAC,CAACiK,SAAF,CAAY/I,GAAZ,EAAiB2I,gBAAjB;EACH,GAxDa;EACV,OAAKK,mBAAL;EACH;;MCCCC;;EACF,mBAAc;EAAA;EAAA;EAAA,iDAMQ,YAAM;EACxBhE,MAAAA,YAAY,CAAC7I,KAAb,CAAmBsG,EAAnB,CAAsBlC,WAAtB,EAA6C,KAAI,CAAC0I,8BAAlD;EACAjE,MAAAA,YAAY,CAAC7I,KAAb,CAAmBsG,EAAnB,CAAsBlC,mBAAtB,EAAqD,KAAI,CAACvD,mBAA1D;EACH,KATa;EAAA,iDAWQ,UAAAkM,UAAU,EAAI;EAChC,UAAM/M,OAAK,GAAGkE,KAAK,CAACC,GAAN,CAAUC,KAAV,CAAd;EADgC,UAExBJ,uBAFwB,GAEI+I,UAAU,CAAC/M,KAAX,CAAiBoF,QAAjB,CAA0B,CAA1B,CAFJ,CAExBpB,uBAFwB;EAAA,UAGxBX,IAHwB,GAGHW,uBAHG,CAGxBX,IAHwB;EAAA,UAGlB2J,UAHkB,GAGHhJ,uBAHG,CAGlBgJ,UAHkB;EAKhC,UAAM5D,OAAO,GAAG;EAAEpJ,QAAAA,KAAK,EAAE+E,eAAe,CAAC/E,OAAD,CAAxB;EAAiCgE,QAAAA,uBAAuB,EAAET,IAAI,CAAC0J,KAAL,CAAW5J,IAAX,CAA1D;EAA4E2J,QAAAA,UAAU,EAAVA;EAA5E,OAAhB;EAEAnE,MAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,YAAxB,EAAgDgF,OAAhD;EACA,UAAMxH,QAAM,GAAGsC,KAAK,CAACC,GAAN,CAAUC,MAAV,CAAf;EACA,OAACxC,QAAM,EAAP,IAAasL,YAAY,CAAC9D,OAAD,EAAU,KAAI,CAAC+D,WAAf,CAAzB;EACH,KArBa;EAAA,8CAuBK,UAAAC,MAAM,EAAI;EACzBA,MAAAA,MAAM,CAACrN,WAAP,GAAqB,KAAI,CAAC2E,QAAL,CAAc2I,OAAd,CAAsBjJ,OAAA,CAAkBrE,WAAxC,CAArB;EAEA,UAAM+I,OAAO,GAAG;EAAEX,QAAAA,IAAI,EAAE,SAAR;EAAmBmF,QAAAA,gBAAgB,EAAEF;EAArC,OAAhB;EAEA,MAAA,KAAI,CAACG,aAAL,CAAmBzE,OAAnB;EACH,KA7Ba;EAAA,yCA+BA,UAAA/G,YAAY,EAAI;EAC1B,UAAMyL,SAAS,GAAG,SAAZA,SAAY,GAAiD;EAAA,uFAAP,EAAO;EAAA,gCAA9CC,OAA8C;EAAA,YAA9CA,OAA8C,6BAApC,wBAAoC;EAC/D/K,QAAAA,CAAC,CAACqD,KAAF,CAAQ2H,MAAM,CAACC,UAAP,CAAkBC,qBAA1B,EAAiD5H,OAAjD,CAAyD;EAAEyH,UAAAA,OAAO,EAAE,MAAX;EAAmBtD,UAAAA,YAAY,EAAEsD;EAAjC,SAAzD;EACH,OAFD;EAIA,UAAMI,aAAa,GAAG,SAAhBA,aAAgB,QAAkB;EAAA,YAAf1N,EAAe,SAAfA,EAAe;EAAA,YAAX2N,IAAW,SAAXA,IAAW;EACpCjF,QAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,MAAxB,EAA0C,IAA1C;EACA,YAAM2J,WAAW,GAAG;EAAEN,UAAAA,OAAO,EAAE,SAAX;EAAsBtN,UAAAA,EAAE,EAAFA,EAAtB;EAA0B2N,UAAAA,IAAI,EAAJA;EAA1B,SAApB;EACApL,QAAAA,CAAC,CAACqD,KAAF,CAAQ2H,MAAM,CAACC,UAAP,CAAkBK,eAA1B,EAA2ChI,OAA3C,CAAmD+H,WAAnD;EACArL,QAAAA,CAAC,CAACqD,KAAF,CAAQ2H,MAAM,CAACC,UAAP,CAAkBM,wBAA1B,EAAoDjI,OAApD,CAA4D,CAAC+H,WAAD,CAA5D;EACH,OALD;EAOA,UAAMG,WAAW,GAAG,SAAdA,WAAc,CAAA7K,IAAI,EAAI;EACxB,YAAM8K,gBAAgB,GAAGpM,YAAY,CAAC0D,EAAb,KAAoB,UAA7C;EACA,YAAM2I,gBAAgB,sBAAQrM,YAAR;EAAsB0D,UAAAA,EAAE,EAAE;EAA1B,UAAtB;EACA,eAAO0I,gBAAgB,GAAGN,aAAa,CAACxK,IAAD,CAAhB,GAAyB,KAAI,CAAC8J,WAAL,CAAiBiB,gBAAjB,CAAhD;EACH,OAJD;EAMA,UAAMC,YAAY,GAAG,SAAfA,YAAe,CAAAhL,IAAI,EAAI;EAAA,8BACSA,IAAI,CAAC+B,QAAL,CAAc,CAAd,CADT;EAAA,YACjBkJ,YADiB,mBACjBA,YADiB;EAAA,YACHb,OADG,mBACHA,OADG;EAAA,YAEjBc,8BAFiB,GAE+CxF,WAF/C,CAEjBwF,8BAFiB;EAAA,YAEeC,2BAFf,GAE+CzF,WAF/C,CAEeyF,2BAFf;EAGzB,YAAMC,kBAAkB,GAAG,CAACF,8BAAD,EAAiCC,2BAAjC,CAA3B;EACA,YAAM3M,OAAO,GAAG4M,kBAAkB,CAACC,QAAnB,CAA4BJ,YAA5B,CAAhB;EACA,eAAOzM,OAAO,GAAGqM,WAAW,CAAC7K,IAAD,CAAd,GAAuBmK,SAAS,CAAC;EAAEC,UAAAA,OAAO,EAAPA,OAAF;EAAWpK,UAAAA,IAAI,EAAJA;EAAX,SAAD,CAA9C;EACH,OAND;EAQAsL,MAAAA,YAAY,CAACC,OAAb,CAAqB7F,WAAW,CAAC8F,4BAAjC,EAA+D9M,YAA/D,EAA6EsM,YAA7E,EAA2Fb,SAA3F;EACH,KA1Da;EAAA,2CA4DE,UAAAzN,WAAW,EAAI;EAC3B,UAAM+O,WAAW,GAAGvL,IAAI,CAAC0J,KAAL,CAAW,KAAI,CAACvI,QAAL,CAAc2I,OAAd,CAAsBjJ,OAAA,CAAkBpE,KAAxC,CAAX,CAApB;EACA8O,MAAAA,WAAW,CAAC1J,QAAZ,GAAuB,CAACrF,WAAD,CAAvB;EAEA,MAAA,KAAI,CAACoN,WAAL,CAAiB2B,WAAjB;EACH,KAjEa;EAAA,uCAmEF,UAAAC,aAAa,EAAI;EACzB,UAAMC,MAAM,GAAGD,aAAa,CAACE,KAAd,CAAoB,GAApB,CAAf;EACA,UAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAMC,KAAN,EAAgB;EAAA,2BACZA,KAAK,CAACH,KAAN,CAAY,GAAZ,CADY;EAAA;EAAA,YAC1BpJ,GAD0B;EAAA,YACrBC,KADqB;EAEjC,kCAAYqJ,GAAZ,sBAAkBtJ,GAAlB,EAAwBwJ,kBAAkB,CAACvJ,KAAD,CAA1C;EACH,OAHD;EAKA,aAAOkJ,MAAM,CAACM,MAAP,CAAcJ,YAAd,EAA4B,EAA5B,CAAP;EACH,KA3Ea;EAAA,4DA6EmB,UAAAK,QAAQ,EAAI;EACzC,UAAMvP,OAAK,GAAGkE,KAAK,CAACC,GAAN,CAAUC,KAAV,CAAd;EADyC,UAEjCoL,UAFiC,GAElBD,QAFkB,CAEjCC,UAFiC;EAIzC,UAAIA,UAAJ,EAAgB;EACZpN,QAAAA,aAAa;EAEb,YAAMqN,aAAa,GAAG,KAAI,CAACC,SAAL,CAAeF,UAAf,CAAtB;EAEA,QAAA,KAAI,CAACG,uBAAL,CAA6B3P,OAA7B;EACA,QAAA,KAAI,CAAC4P,SAAL,CAAeH,aAAf;EACH;EACJ,KAzFa;EAAA,qDA2FY,UAAAzP,KAAK,EAAI;EAC/B,UAAIA,KAAK,GAAG6P,cAAR,EAAJ,EAA8B;EAC1B7P,QAAAA,KAAK,GAAG6P,cAAR,GAAyB1H,IAAzB,GAAgC,EAAhC;EACH;EACJ,KA/Fa;EAAA,wCAqGD,UAAAsH,aAAa;EAAA,aAAI,WAAWA,aAAX,IAA4B,QAAQA,aAAxC;EAAA,KArGZ;EAAA,0CAsGC,UAAAA,aAAa;EAAA,aAAI,aAAaA,aAAjB;EAAA,KAtGd;EAAA,2CAuGE,UAAAA,aAAa,EAAI;EAC7B,UAAMK,KAAK,GAAG,KAAI,CAACC,UAAL,CAAgBN,aAAhB,CAAd;EACA,UAAMO,OAAO,GAAG,KAAI,CAACC,YAAL,CAAkBR,aAAlB,CAAhB;EACA,UAAMS,UAAU,GAAGJ,KAAK,IAAIE,OAA5B;EACA,aAAOE,UAAP;EACH,KA5Ga;EACV,SAAKxL,QAAL,GAAgBC,UAAU,CAACC,WAAX,EAAhB;EAEA,SAAKgI,mBAAL;EACH;;;gCA6FS6C,eAAe;EACrB,WAAKU,QAAL,GAAgB,KAAKC,aAAL,CAAmBX,aAAnB,CAAhB;EACA,WAAKU,QAAL,IAAiB,KAAKE,gBAAL,CAAsBZ,aAAtB,CAAjB;EACH;;;;;MC1GCa,UACF,mBAAc;EAAA;EAAA;EAAA,+CAIQ,YAAM;EACxBzH,IAAAA,YAAY,CAACC,OAAb,CAAqBxC,EAArB,CAAwBlC,UAAxB,EAA8C,KAAI,CAACxD,UAAnD;EACH,GANa;EAAA,sCAQD,UAAAuH,IAAI,EAAI;EACjB,QAAMnI,OAAK,GAAGkE,KAAK,CAACC,GAAN,CAAUC,KAAV,CAAd;EACA,QAAMjE,IAAE,GAAG+D,KAAK,CAACC,GAAN,CAAUC,EAAV,CAAX;EAEA,QAAMzC,gBAAc,GAAGuC,KAAK,CAACC,GAAN,CAAUC,cAAV,CAAvB;EACA,QAAMmM,qBAAqB,sBAAQ5O,gBAAR;EAAwBxB,MAAAA,EAAE,EAAEA,IAAE;EAA9B,MAA3B;EAEA0I,IAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,cAAxB,EAAkDmM,qBAAlD;EACA1H,IAAAA,YAAY,CAACM,SAAb,CAAuBvD,IAAvB,CAA4BxB,gBAA5B;EAEA,QAAMgB,QAAQ,GAAG,CAACmL,qBAAD,CAAjB;EAEAvQ,IAAAA,OAAK,GAAGwQ,cAAR,CAAuBpL,QAAvB;EAEA,IAAA,KAAI,CAACqL,aAAL,CAAmB,KAAI,CAACC,aAAL,CAAmBvI,IAAnB,CAAnB;EACH,GAvBa;EAAA,yCAyBE,UAAAwI,QAAQ,EAAI;EACxB,QAAM3Q,OAAK,GAAGkE,KAAK,CAACC,GAAN,CAAUC,KAAV,CAAd;EACA,QAAMjE,IAAE,GAAG+D,KAAK,CAACC,GAAN,CAAUC,EAAV,CAAX;EAEA,QAAMgB,QAAQ,GAAGpF,OAAK,GAAGoF,QAAR,EAAjB;EACA,QAAMwL,OAAO,GAAG,SAAVA,OAAU,CAACC,KAAD,EAAQ1Q,EAAR;EAAA,aAAe0Q,KAAK,IAAIA,KAAK,KAAK1Q,EAAE,EAApC;EAAA,KAAhB;EACA,QAAM2Q,WAAW,GAAG,SAAdA,WAAc,CAAChI,OAAD,EAAUiI,KAAV,EAAoB;EACpC,UAAMC,UAAU,GAAG5L,QAAQ,CAAC2L,KAAD,CAA3B;EADoC,UAExBF,KAFwB,GAEdG,UAFc,CAE5B7Q,EAF4B;EAGpC,UAAM8Q,QAAQ,GAAGL,OAAO,CAACC,KAAD,EAAQ1Q,IAAR,CAAxB;EACA,aAAO8Q,QAAQ,GAAGN,QAAH,GAAcK,UAA7B;EACH,KALD;EAOA,QAAME,WAAW,GAAG9L,QAAQ,CAACwC,GAAT,CAAakJ,WAAb,CAApB;EACA9Q,IAAAA,OAAK,GAAGoF,QAAR,CAAiB8L,WAAjB;EACH,GAxCa;EAAA,yCA0CE,UAAA/I,IAAI,EAAI;EACpB,QAAM/G,mBAAiB,GAAG8C,KAAK,CAACC,GAAN,CAAUC,iBAAV,CAA1B;EACA,QAAM7C,iBAAe,GAAG2C,KAAK,CAACC,GAAN,CAAUC,eAAV,CAAxB;EACA,QAAM5C,gBAAc,GAAG0C,KAAK,CAACC,GAAN,CAAUC,cAAV,CAAvB;EACA,QAAM3C,qBAAmB,GAAGyC,KAAK,CAACC,GAAN,CAAUC,mBAAV,CAA5B;EACA,QAAMlD,mBAAiB,GAAGgD,KAAK,CAACC,GAAN,CAAUC,iBAAV,CAA1B;EACA,QAAM1C,kBAAgB,GAAGwC,KAAK,CAACC,GAAN,CAAUC,gBAAV,CAAzB;EAEA,QAAM+M,eAAe,GAAG,KAAI,CAACC,wBAAL,CAA8B3P,qBAA9B,CAAxB;EAEA,QAAM4P,YAAY,GAAGnQ,mBAAiB,OAAOkD,UAAA,CAAqB1E,MAAlE;EACA,QAAMmC,OAAO,GAAG,KAAI,CAACyP,mBAAL,CAAyBH,eAAzB,EAA0CE,YAA1C,CAAhB;EAEA,QAAME,aAAa,GAAG,KAAI,CAACC,gBAAL,CAAsBjQ,iBAAtB,EAAuCH,mBAAvC,CAAtB;EACA,QAAMuG,oBAAoB,GAAG,KAAI,CAAC8J,eAAL,CAAqB5P,OAArB,EAA8BJ,qBAA9B,CAA7B;EAEA,QAAME,gBAAc,GAAGuC,KAAK,CAACC,GAAN,CAAUC,cAAV,CAAvB;EACA,QAAMkJ,gBAAgB;EAClB9L,MAAAA,cAAc,EAAEA,gBAAc,CAAC2G,IAAD,CADZ;EAElBoJ,MAAAA,aAAa,EAAbA;EAFkB,OAGd5J,oBAAoB,IAAI;EAAEA,MAAAA,oBAAoB,EAApBA;EAAF,KAHV,MAIfjG,kBAJe,CAAtB;EAMA,QAAM6O,qBAAqB,sBAAQ5O,gBAAR;EAAwB2L,MAAAA,gBAAgB,EAAhBA;EAAxB,MAA3B;EAEA,WAAOiD,qBAAP;EACH,GApEa;EAAA,oDAsEa,UAAA9O,mBAAmB;EAAA,WAC1CA,mBAAmB,MAAM,0BAA0BA,mBAAmB,EAD5B;EAAA,GAtEhC;EAAA,2CAwEI,UAACI,OAAD,EAAUJ,mBAAV;EAAA,WAAkCI,OAAO,IAAIiF,QAAQ,CAACrF,mBAAmB,GAAGkG,oBAAvB,CAArD;EAAA,GAxEJ;EAAA,+CAyEQ,UAACwJ,eAAD,EAAkBE,YAAlB;EAAA,WAAmCF,eAAe,IAAIE,YAAtD;EAAA,GAzER;EAAA,4CA0EK,UAAC9P,eAAD,EAAkBH,iBAAlB;EAAA,WAAyCG,eAAe,GAAGH,iBAAiB,EAApB,GAAyB,EAAjF;EAAA,GA1EL;EACV,OAAKwL,mBAAL;EACH;;MCFC8E;;EACF,mBAAc;EAAA;EAAA;EAAA,2CAIE,KAJF;EAAA,+CAMMC,EAAE,CAACC,UAAH,CAAc,EAAd,CANN;EAAA,yCAOAC,SAPA;EAAA,wCAQDA,SARC;EAAA,uCAWF,IAAI1G,SAAJ,EAXE;EAAA,sCAYH0G,SAZG;EAAA,uCAaF,EAbE;EAAA,qCAcJ,KAdI;EAAA,2CAeEA,SAfF;EAAA,wCAgBDrS,UAAU,CAACE,MAhBV;EAAA,uCAiBFF,UAAU,CAACC,KAjBT;EAAA,wCAkBDkS,EAAE,CAACC,UAAH,CAAc,CAACpS,UAAU,CAACE,MAAZ,EAAoBF,UAAU,CAACC,KAA/B,CAAd,CAlBC;EAAA,8CAmBK,EAnBL;EAAA,+CAoBMkS,EAAE,CAACC,UAAH,CAAcpS,UAAU,CAACE,MAAzB,CApBN;EAAA,6CAqBIiS,EAAE,CAACC,UAAH,CAAc,KAAd,CArBJ;EAAA,oDAsBWC,SAtBX;EAAA,4CAuBGA,SAvBH;EAAA,sCAwBHF,EAAE,CAACC,UAAH,CAAc,KAAd,CAxBG;EAAA,0CAyBCD,EAAE,CAACC,UAAH,CAAc,EAAd,CAzBD;EAAA,iDA0BQD,EAAE,CAACC,UAAH,CAAc,EAAd,CA1BR;EAAA,0DA2BiB,CAACzS,SAAS,CAACG,MAAV,CAAiBJ,MAAlB,EAA0BC,SAAS,CAACC,MAAV,CAAiBF,MAA3C,CA3BjB;EAAA,iDA4BQ,EA5BR;EAAA,8CA+BK,IAAIoR,OAAJ,EA/BL;EAAA,4CAgCG;EAAEnI,MAAAA,IAAI,EAAE;EAAR,KAhCH;EAAA,4CAmCG,IAAI0E,KAAJ,EAnCH;EAAA,oCAoCL8E,EAAE,CAACC,UAAH,CAAc,KAAd,CApCK;EAAA,2CAuCED,EAAE,CAACC,UAAH,CAAc,KAAd,CAvCF;EAAA,gDAwCO,EAxCP;EAAA,oDAyCW,EAzCX;EAAA,2CA4CED,EAAE,CAACC,UAAH,CAAc,EAAd,CA5CF;EAAA,iDA6CQD,EAAE,CAACG,eAAH,EA7CR;EAAA,iDAyDQ,YAAM;EACxBjJ,MAAAA,YAAY,CAAC3E,KAAb,CAAmB+B,MAAnB,CAA0B,UAACJ,GAAD,EAAMC,KAAN,EAAgB;EACtC,YAAI,OAAO,KAAI,CAACD,GAAD,CAAX,KAAqB,UAAzB,EAAqC;EACjC,UAAA,KAAI,CAACA,GAAD,CAAJ,CAAUC,KAAV;EACH,SAFD,MAEO;EACH,UAAA,KAAI,CAACD,GAAD,CAAJ,GAAYC,KAAZ;EACH;EACJ,OAND;EAOH,KAjEa;EAAA,iCAmER,UAAAD,GAAG;EAAA,aAAK,KAAI,CAACkM,GAAL,CAASlM,GAAT,IAAgB,KAAI,CAACA,GAAD,CAApB,GAA4BgM,SAAjC;EAAA,KAnEK;EAAA,iCAqER,UAAAhM,GAAG;EAAA,aAAIA,GAAG,IAAI,KAAX;EAAA,KArEK;EAAA,kCAuEP,UAAAmM,SAAS,EAAI;EAChB,MAAA,KAAI,CAAC7R,EAAL,GAAU6R,SAAS,CAAC7R,EAApB;EACA,MAAA,KAAI,CAACH,KAAL,GAAagS,SAAS,CAAChS,KAAvB;EACA,MAAA,KAAI,CAACW,IAAL,GAAYqR,SAAS,CAACrR,IAAtB;EACA,MAAA,KAAI,CAACH,IAAL,GAAYA,MAAI,CAACwR,SAAS,CAACvO,SAAV,EAAD,CAAhB;EACA,MAAA,KAAI,CAACnC,SAAL,GAAiB0Q,SAAS,CAAC1Q,SAA3B;EACA,MAAA,KAAI,CAACpC,MAAL,GAAc8S,SAAS,CAAC9S,MAAV,EAAd;EACA,MAAA,KAAI,CAACe,iBAAL,GAAyB+R,SAAS,CAAC1Q,SAAV,CAAoBrB,iBAApB,CAAzB;EACH,KA/Ea;EACV,SAAK2M,mBAAL;EACH;;;0BA6CyB;EACtB,UAAMuE,eAAe,GAAG,CAAC,CAAC,KAAKzQ,YAAL,GAAoBuR,MAA9C;EACA,UAAMC,YAAY,GAAG,KAAKhR,iBAAL,OAA6B1B,UAAU,CAACE,MAA7D;EACA,aAAOiS,EAAE,CAACC,UAAH,CAAc,KAAK7Q,+BAAL,IAAwCoQ,eAAxC,IAA2De,YAAzE,CAAP;EACH;;;0BAEqC;EAClC,aAAO,KAAKC,4BAAL,CAAkCzD,QAAlC,CAA2C,KAAKxP,MAAL,CAAYH,WAAZ,EAA3C,CAAP;EACH;;;;AA2BL,cAAe,IAAI2S,KAAJ,EAAf;;ECpFA,IAAMU,eAAe,GAAG,SAAlBA,eAAkB,CAAAC,kBAAkB;EAAA,SACtCA,kBAAkB,IAAIxJ,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,MAAA,CAAiBnC,YAAzC,EAAuDoQ,kBAAvD,CADgB;EAAA,CAA1C;EAGA,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAAC,sBAAsB;EAAA,SAC9CA,sBAAsB,IAAI1J,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,MAAA,CAAiBlC,gBAAzC,EAA2DqQ,sBAA3D,CADoB;EAAA,CAAlD;AAGA,EAAO,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,OAAoD;EAAA,MAAjDH,kBAAiD,QAAjDA,kBAAiD;EAAA,MAA7BE,sBAA6B,QAA7BA,sBAA6B;EAC/EH,EAAAA,eAAe,CAACC,kBAAD,CAAf;EACAC,EAAAA,mBAAmB,CAACC,sBAAD,CAAnB;EACH,CAHM;AAKP,EAAO,IAAMzQ,kBAAgB,GAAG,SAAnBA,gBAAmB,CAAAkC,uBAAuB,EAAI;EACvD,MAAMyO,cAAc,GAAGvO,KAAK,CAACC,GAAN,CAAUC,QAAA,CAAmB9D,MAA7B,CAAvB;EACA,MAAM+H,OAAO,GAAG;EAAE9D,IAAAA,MAAM,EAAEP,uBAAV;EAAmCQ,IAAAA,QAAQ,EAAE,kBAA7C;EAAiEC,IAAAA,iBAAiB,EAAEgO;EAApF,GAAhB;EAEApJ,EAAAA,2BAA2B,CAAC,YAAM;EAC9BvE,IAAAA,gBAAgB,CAACuD,OAAD,CAAhB;EACH,GAF0B,CAA3B;EAGH,CAPM;EASP,IAAMqK,YAAY,GAAG,SAAfA,YAAe,CAAAtS,UAAQ;EAAA,SAAIyI,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,QAAA,CAAmB9D,MAA3C,EAAmDF,UAAnD,CAAJ;EAAA,CAA7B;EAEA,IAAMsM,oBAAoB,GAAG,SAAvBA,oBAAuB,QAAwB;EAAA,MAArBiG,cAAqB,SAArBA,cAAqB;EACjD,MAAMC,SAAS,GAAGD,cAAc,CAACE,IAAf,CAAoB;EAAA,QAAG1K,IAAH,SAAGA,IAAH;EAAA,WAAcA,IAAI,CAACuG,QAAL,CAAc,QAAd,CAAd;EAAA,GAApB,CAAlB;EACA7F,EAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,MAAA,CAAiBpC,OAAzC,EAAkD4Q,SAAlD;EAEA,MAAIA,SAAJ,EAAe;EACX,QAAMxS,QAAQ,GAAG,IAAI8H,QAAJ,CAAa9D,kBAAA,CAA6BzF,OAA1C,CAAjB;EACA,QAAMmU,QAAQ,GAAG1S,QAAQ,CAAC0S,QAAT,CAAkB;EAC/B7Q,MAAAA,YAAY,EAAEwI,OAAO,CAACvG,KAAK,CAACC,GAAN,CAAUC,MAAA,CAAiBnC,YAA3B,CAAD,CADU;EAE/BC,MAAAA,gBAAgB,EAAEgC,KAAK,CAACC,GAAN,CAAUC,MAAA,CAAiBlC,gBAA3B;EAFa,KAAlB,CAAjB;EAKA,QAAM6Q,QAAQ,GAAG3S,QAAQ,CAAC2S,QAAT,EAAjB;EAEA,QAAM3K,aAAa,GAAG;EAAE2K,MAAAA,QAAQ,EAARA,QAAF;EAAYD,MAAAA,QAAQ,EAARA;EAAZ,KAAtB;EACA,QAAM9S,OAAK,GAAGkE,KAAK,CAACC,GAAN,CAAUC,KAAV,CAAd;EAEA,QAAM4O,OAAO,GAAGhT,OAAK,GAAGmF,cAAR,EAAhB;EAEA,QAAM8N,WAAW,GAAG;EAAEC,MAAAA,SAAS,EAAEF,OAAO,CAACE,SAAR,EAAb;EAAkCC,MAAAA,QAAQ,EAAEH,OAAO,CAACG,QAAR;EAA5C,KAApB;EACA,QAAMhO,cAAc,GAAG;EACnBiO,MAAAA,IAAI,EAAEJ,OAAO,CAACI,IAAR,EADa;EAEnBC,MAAAA,OAAO,EAAEL,OAAO,CAACM,eAAR,EAFU;EAInBC,MAAAA,UAAU,EAAEP,OAAO,CAACO,UAAR,EAJO;EAKnBC,MAAAA,eAAe,EAAER,OAAO,CAACS,aAAR,EALE;EAMnBC,MAAAA,MAAM,EAAEV,OAAO,CAACW,QAAR;EANW,KAAvB;EAQA,QAAMtL,OAAO,GAAG;EAAEhF,MAAAA,IAAI,EAAE;EAAE4P,QAAAA,WAAW,EAAXA,WAAF;EAAe9N,QAAAA,cAAc,EAAdA;EAAf;EAAR,KAAhB;EACA,QAAMyO,eAAe,GAAG;EAAExL,MAAAA,aAAa,EAAbA,aAAF;EAAiB5D,MAAAA,QAAQ,EAAE,uBAA3B;EAAoD2D,MAAAA,IAAI,EAAE,gBAA1D;EAA4EE,MAAAA,OAAO,EAAPA;EAA5E,KAAxB;EAEAjI,IAAAA,QAAQ,CAACyT,cAAT,CAAwBD,eAAxB,EAAyClB,YAAzC;EACH;EACJ,CAhCD;;ECtBO,IAAMoB,OAAO,GAAG,SAAVA,OAAU,OAAe;EAAA,MAAZvM,KAAY,QAAZA,KAAY;EAClCsB,EAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,aAAxB,EAAiDmD,KAAjD;EACA,MAAMpG,qBAAmB,GAAG+C,KAAK,CAACC,GAAN,CAAUC,mBAAV,CAA5B;EACA,MAAMzD,MAAI,GAAGuD,KAAK,CAACC,GAAN,CAAUC,IAAV,CAAb;EACA,MAAM6C,MAAM,GAAGtG,MAAI,GAAGsG,MAAP,EAAf;EACA,MAAMvG,cAAY,GAAGS,qBAAmB,GAAGmG,qBAAqB,CAACnG,qBAAD,EAAsB8F,MAAtB,EAA8BM,KAA9B,CAAxB,GAA+D,EAAvG;EAEAsB,EAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,YAAxB,EAAgD1D,cAAhD;EACH,CARM;AAUP,EAAO,IAAMqT,eAAe,GAAG,SAAlBA,eAAkB;EAAA,SAAMlL,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,QAAxB,EAA4C,IAA5C,CAAN;EAAA,CAAxB;EAEP,IAAMoI,kBAAkB,GAAG,SAArBA,kBAAqB,GAAM;EAC7B,MAAMpM,UAAQ,GAAG,IAAI8H,QAAJ,CAAa9D,kBAAA,CAA6B1F,OAA1C,CAAjB;EACA,MAAMoU,QAAQ,GAAG1S,UAAQ,CAAC0S,QAAT,EAAjB;EACA,MAAMC,QAAQ,GAAG3S,UAAQ,CAAC2S,QAAT,EAAjB;EAEA,MAAM3R,mBAAiB,GAAG8C,KAAK,CAACC,GAAN,CAAUC,iBAAV,CAA1B;EACA,MAAMiE,OAAO,GAAG;EAAE2L,IAAAA,aAAa,EAAE,KAAjB;EAAwBC,IAAAA,kBAAkB,EAAE,CAAC,CAAC7S,mBAAiB;EAA/D,GAAhB;EAEA,MAAMgH,aAAa,GAAG;EAAE0L,IAAAA,OAAO,EAAPA,OAAF;EAAWC,IAAAA,eAAe,EAAfA,eAAX;EAA4BjB,IAAAA,QAAQ,EAARA,QAA5B;EAAsCC,IAAAA,QAAQ,EAARA;EAAtC,GAAtB;EACA,MAAMa,eAAe,GAAG;EAAExL,IAAAA,aAAa,EAAbA,aAAF;EAAiB5D,IAAAA,QAAQ,EAAE,qBAA3B;EAAkD2D,IAAAA,IAAI,EAAE,MAAxD;EAAgEE,IAAAA,OAAO,EAAPA;EAAhE,GAAxB;EAEAjI,EAAAA,UAAQ,CAACyT,cAAT,CAAwBD,eAAxB,EAAyC,UAAAxT,UAAQ,EAAI;EACjDyI,IAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,QAAA,CAAmB/D,IAA3C,EAAiDD,UAAjD;EACH,GAFD;EAGH,CAdD;;ECbA,IAAM8T,gBAAgB,GAAG,CAAC,cAAD,EAAiB,QAAjB,EAA2B,QAA3B,EAAqC,gBAArC,CAAzB;EACA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAAAC,aAAa,EAAI;EACrC,SAAO;EAEHjN,IAAAA,QAAQ,EAAE,kBAACtB,GAAD,EAAMC,KAAN,EAAgB;EACtB,UAAMuO,OAAO,GAAG,UAAUD,aAA1B;EACA,UAAME,WAAW,GAAGD,OAAO,IAAI,CAACH,gBAAgB,CAACxF,QAAjB,CAA0B0F,aAAa,CAACjM,IAAxC,CAAhC;EACA,UAAM+H,UAAU,GAAGoE,WAAW,IAAI,aAAaF,aAA/C;EACA,UAAMG,UAAU,GAAGrE,UAAU,IAAIkE,aAAa,CAACI,OAAd,CAAsBvC,MAAtB,KAAiC,CAAlE;EACA,UAAMwC,MAAM,GAAGF,UAAU,IAAIH,aAAa,CAACI,OAAd,CAAsB,CAAtB,CAA7B;EACA,UAAME,0BAA0B,GAAGD,MAAM,IAAIA,MAAM,CAAC5O,GAAD,CAAN,KAAgBC,KAA7D;EACA,UAAMjE,OAAO,GAAG,CAACqO,UAAD,IAAewE,0BAA/B;EACA,aAAOJ,WAAW,IAAIzS,OAAtB;EACH;EAXE,GAAP;EAaH,CAdD;EAgBA,IAAM8S,oBAAoB,GAAG,SAAvBA,oBAAuB,CAAAP,aAAa,EAAI;EAAA,yBACrBD,eAAe,CAACC,aAAD,CADM;EAAA,MAClCjN,QADkC,oBAClCA,QADkC;EAE1C,MAAMyN,WAAW,GAAGzN,QAAQ,CAAC,KAAD,EAAQ,QAAR,CAA5B;EACA,MAAM0N,YAAY,GAAG1N,QAAQ,CAAC,MAAD,EAAS,QAAT,CAA7B;EACA,MAAM6I,OAAO,GAAG4E,WAAW,IAAIC,YAA/B;EAEA,SAAO7E,OAAP;EACH,CAPD;EASA,IAAM8E,mBAAmB,GAAG,SAAtBA,mBAAsB,CAAC3F,GAAD,EAAM4F,kBAAN,EAA6B;EAAA,MAC7C5M,IAD6C,GACpC4M,kBADoC,CAC7C5M,IAD6C;EAErD,MAAM/H,QAAQ,GAAG,IAAI8H,QAAJ,CAAaC,IAAb,CAAjB;EACA,MAAM2K,QAAQ,GAAG1S,QAAQ,CAAC0S,QAAT,EAAjB;EACA,MAAMC,QAAQ,GAAG3S,QAAQ,CAAC2S,QAAT,EAAjB;EAEA,MAAM3K,aAAa,GAAG;EAAE2K,IAAAA,QAAQ,EAARA,QAAF;EAAYD,IAAAA,QAAQ,EAARA,QAAZ;EAAsB9K,IAAAA,aAAa,EAAE;EAArC,GAAtB;EAEA,MAAM4L,eAAe,GAAG,SAAlBA,eAAkB,CAAAzL,IAAI;EAAA,WAAK;EAAEC,MAAAA,aAAa,EAAbA,aAAF;EAAiB5D,MAAAA,QAAQ,mBAAY2D,IAAZ,aAAzB;EAAqDA,MAAAA,IAAI,EAAJA;EAArD,KAAL;EAAA,GAA5B;EACA/H,EAAAA,QAAQ,CAACyT,cAAT,CAAwBD,eAAe,CAACzL,IAAD,CAAvC,EAA+C,UAAA/H,QAAQ;EAAA,8BAAU+O,GAAV,sBAAgBhH,IAAhB,EAAuB/H,QAAvB;EAAA,GAAvD;EACH,CAVD;EAYA,IAAMqM,0BAA0B,GAAG,SAA7BA,0BAA6B,OAAwB;EAAA,MAArBkG,cAAqB,QAArBA,cAAqB;EACvD,MAAMxQ,qBAAmB,GAAGwQ,cAAc,CAAC9K,MAAf,CAAsB8M,oBAAtB,CAA5B;EACA9L,EAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,mBAAxB,EAAuDjC,qBAAvD;EACA,MAAM6S,2BAA2B,GAAG7S,qBAAmB,CAACmN,MAApB,CAA2BwF,mBAA3B,EAAgD,EAAhD,CAApC;EAEAjM,EAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,QAAA,CAAmBxF,KAA3C,EAAkDoW,2BAAlD;EACH,CAND;;MChCMC;;;mCACM/Q;gDAEa,gBAMf;EAAA,QALFgR,qBAKE,QALFA,qBAKE;EAAA,QAJFlU,aAIE,QAJFA,WAIE;EAAA,QAHFuQ,aAGE,QAHFA,aAGE;EAAA,QAFFc,kBAEE,QAFFA,kBAEE;EAAA,QADFE,sBACE,QADFA,sBACE;EACF1J,IAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,WAAxB,EAA+CpD,aAA/C;EAEAkD,IAAAA,KAAK,CAACC,GAAN,CAAUC,+BAAV,KAAwD,KAAI,CAAC+Q,eAAL,CAAqBD,qBAArB,CAAxD;EACArM,IAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,iBAAxB,EAAqDmN,aAArD;EAEAiB,IAAAA,eAAe,CAAC;EAAEH,MAAAA,kBAAkB,EAAE+C,MAAM,CAAC/C,kBAAD,CAA5B;EAAkDE,MAAAA,sBAAsB,EAAtBA;EAAlD,KAAD,CAAf;EACH;6CAEiB,YAAM;EACpB,IAAA,KAAI,CAAC8C,yBAAL;EADoB,QAGZC,mBAHY,GAGY,KAAI,CAACC,IAAL,GAAYC,qBAHxB,CAGZF,mBAHY;EAIpB,IAAA,KAAI,CAACG,kBAAL,CAAwBH,mBAAxB;EACH;6CAEiB,UAAAnU,qBAAmB,EAAI;EACrC,QAAI;EACA0H,MAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,mBAAxB,EAAuDb,IAAI,CAAC0J,KAAL,CAAW9L,qBAAX,CAAvD;EACH,KAFD,CAEE,OAAOuU,CAAP,EAAU;EACR,UAAMpU,WAAS,GAAG4C,KAAK,CAACC,GAAN,CAAUC,SAAV,CAAlB;EADQ,UAEA7F,yBAFA,GAE8B6F,aAF9B,CAEA7F,yBAFA;EAGR,UAAMoX,MAAM,GAAGrU,WAAS,CAAC/C,yBAAD,CAAxB;EACAgM,MAAAA,QAAQ,CAACC,SAAT,CAAmB,cAAnB,EAAmCmL,MAAnC,EAA2C,IAA3C;EACH;EACJ;uDAE2B,YAAM;EAAA,QACtBvW,MADsB,GACXgF,SADW,CACtBhF,MADsB;EAAA,QAEtBC,QAFsB,GAEDD,MAFC,CAEtBC,QAFsB;EAAA,QAEZH,QAFY,GAEDE,MAFC,CAEZF,MAFY;EAI9B,QAAM0W,UAAU,GAAG1R,KAAK,CAACC,GAAN,CAAUC,MAAV,EAA4BrF,WAA5B,EAAnB;EACA,QAAMiN,YAAY,GAAG,KAAI,CAACrL,IAAL,GAAYqL,YAAZ,EAArB;EACA,QAAM6J,UAAU,GAAG3W,QAAM,KAAK0W,UAA9B;EACA,QAAME,OAAO,GAAG9J,YAAY,CAACjN,WAAb,OAA+BM,QAA/C;EAEAwJ,IAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,aAAxB,EAAiDyR,UAAU,IAAIC,OAA/D;EACH;+CAEmB,UAAAvG,QAAQ,EAAI;EAC5B,QAAMwG,UAAU,GAAGxG,QAAQ,CAACyG,MAAT,KAAoB,UAAvC;EACAD,IAAAA,UAAU,IAAIlN,YAAY,CAAC7I,KAAb,CAAmB4F,IAAnB,CAAwBxB,WAAxB,EAA+CmL,QAA/C,CAAd;EACH;0CAEc,YAAM;EACjB,IAAA,KAAI,CAAC0G,KAAL;EACH;oCAEQ,UAAAC,MAAM,EAAI;EACfhS,IAAAA,KAAK,CAACiS,IAAN,CAAWD,MAAX;EACAE,IAAAA,MAAM,CAACC,MAAP,CAAc,KAAd,EAAoBH,MAApB,EAA4B;EAAEhS,MAAAA,KAAK,EAALA;EAAF,KAA5B;EAEA,IAAA,KAAI,CAACoS,eAAL;EACA,IAAA,KAAI,CAACC,iBAAL;EACH;sCAEU,YAAM;EACb1N,IAAAA,YAAY,CAACM,SAAb,CAAuBvD,IAAvB,CAA4BxB,MAA5B;EACH;mCAEO,YAAM;EACVyE,IAAAA,YAAY,CAAC3E,KAAb,CAAmB0B,IAAnB,CAAwBxB,YAAxB,EAAgD,EAAhD;EACH;8CAEkB,YAAM;EAAA,qBAC2BF,KAAK,CAACC,GAAN,CAAUC,YAAV,CAD3B;EAAA,QACb4I,UADa,cACbA,UADa;EAAA,QACDhJ,uBADC,cACDA,uBADC;EAErB,QAAMwS,kBAAkB,GAAGxJ,UAAU,KAAK5I,gBAA1C;EACAoS,IAAAA,kBAAkB,IAAI1U,kBAAgB,CAACkC,uBAAD,CAAtC;EACH;4CACgB;EAAA,WAAME,KAAK,CAAC6N,GAAN,CAAU3N,YAAV,KAAqC,KAAI,CAACtC,gBAAL,EAA3C;EAAA;+CAEG,YAAM;EAAA,6BAUlB4L,MAAM,CAACC,UAVW;EAAA,QAElB8I,qBAFkB,sBAElBA,qBAFkB;EAAA,QAGlBC,YAHkB,sBAGlBA,YAHkB;EAAA,QAIlB9I,qBAJkB,sBAIlBA,qBAJkB;EAAA,QAKlBI,eALkB,sBAKlBA,eALkB;EAAA,QAMlB2I,aANkB,sBAMlBA,aANkB;EAAA,QAOlBC,YAPkB,sBAOlBA,YAPkB;EAAA,QAQlB3I,wBARkB,sBAQlBA,wBARkB;EAAA,QASlB4I,gBATkB,sBASlBA,gBATkB;EAYtB,QAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAAC,EAAE,EAAI;EAC3BlO,MAAAA,YAAY,CAAC7I,KAAb,CAAmB4F,IAAnB,CAAwBxB,mBAAxB,EAAuD2S,EAAvD;EACH,KAFD;EAGArU,IAAAA,CAAC,CAACqD,KAAF,CAAQ0Q,qBAAR,EAA+BvQ,SAA/B,CAAyC4Q,gBAAzC;EACApU,IAAAA,CAAC,CAACqD,KAAF,CAAQ2Q,YAAR,EAAsBxQ,SAAtB,CAAgC9D,aAAhC;EAEA,QAAMkI,YAAY,GAAG,KAAI,CAACtK,KAAL,GAAagX,YAAlC;EACA,QAAMC,aAAa,GAAGhN,WAAW,CAAC;EAAEK,MAAAA,YAAY,EAAZA;EAAF,KAAD,CAAjC;EAEA5H,IAAAA,CAAC,CAACqD,KAAF,CAAQ6H,qBAAR,EAA+B1H,SAA/B,CAAyC+Q,aAAzC;EACAvU,IAAAA,CAAC,CAACqD,KAAF,CAAQiI,eAAR,EAAyB9H,SAAzB,CAAmCnD,cAAnC;EACAL,IAAAA,CAAC,CAACqD,KAAF,CAAQ4Q,aAAR,EAAuBzQ,SAAvB,CAAiC,KAAI,CAAC+P,KAAtC;EACAvT,IAAAA,CAAC,CAACqD,KAAF,CAAQ6Q,YAAR,EAAsB1Q,SAAtB,CAAgC,KAAI,CAACgR,iBAArC;EACAxU,IAAAA,CAAC,CAACqD,KAAF,CAAQkI,wBAAR,EAAkC/H,SAAlC,CAA4C,KAAI,CAACiR,cAAjD;EAEAzU,IAAAA,CAAC,CAACqD,KAAF,CAAQ8Q,gBAAR,EAA0B3Q,SAA1B,CAAoC4E,WAApC;EACH;;EAGL,IAAMsM,EAAE,GA